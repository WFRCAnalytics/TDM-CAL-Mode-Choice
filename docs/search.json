[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "",
    "text": "This section prepares the Python environment with all necessary libraries and configurations. We’ll import data manipulation libraries (pandas, numpy), and visualization tools (matplotlib, seaborn).\n\n\n!conda install -c conda-forge numpy pandas matplotlib seaborn requests pathlib BigQuery\n\n\n\n\n\nShow the code\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport importlib.util\nfrom pathlib import Path\nimport sys\nimport os\nimport requests\nimport io\n\nfrom dotenv import load_dotenv\nload_dotenv()\n\n\nTrue\n\n\n\n\n\n\n\n\n\n\nShow the code\ndef fetch_github(\n    url: str,\n    mode: str = \"private\",\n    token_env_var: str = \"GITHUB_TOKEN\"\n) -&gt; requests.Response:\n    \"\"\"\n    Fetch content from GitHub repositories.\n\n    Args:\n        url: GitHub raw URL (e.g., https://raw.githubusercontent.com/...)\n        mode: \"public\" for public repos, \"private\" for private repos requiring authentication\n        token_env_var: Name of environment variable containing GitHub token (default: GITHUB_TOKEN)\n\n    Returns:\n        requests.Response object\n\n    Raises:\n        ValueError: If token is missing for private mode or invalid mode\n        requests.HTTPError: If request fails\n    \"\"\"\n    # Validate mode\n    if mode not in [\"public\", \"private\"]:\n        raise ValueError(f\"mode must be 'public' or 'private', got '{mode}'\")\n\n    if mode == \"public\":\n        response = requests.get(url, timeout=30)\n    else:\n        token = os.getenv(token_env_var)\n        if not token:\n            raise ValueError(\n                f\"GitHub token not found in environment variable '{token_env_var}'. \"\n                f\"Check your .env file has: {token_env_var}=your_token_here\"\n            )\n\n        headers = {\n            'Authorization': f'token {token}',\n            'Accept': 'application/vnd.github.v3.raw'\n        }\n        response = requests.get(url, headers=headers, timeout=30)\n\n    response.raise_for_status()\n    return response\n\n\n\n\n\n\n\nShow the code\n# # Import global TDM functions from remote 'Resource' repo\n\n# Fetch and import BigQuery module\nresponse = fetch_github(\n    'https://raw.githubusercontent.com/WFRCAnalytics/Resources/refs/heads/master/2-Python/global-functions/BigQuery.py',\n    mode=\"public\"\n)\n\nBigQuery = importlib.util.module_from_spec(importlib.util.spec_from_loader('BigQuery', loader=None))\nexec(response.text, BigQuery.__dict__)\n\n# Initiatlize BigQuery Client\nclient = BigQuery.getBigQueryClient_Confidential2023UtahHTS()\n\n\npukar.bhandari\nC:/Users/Pukar.Bhandari/.private/confidential-2023-utah-hts-5fd7ddd219a7.json"
  },
  {
    "objectID": "index.html#install-libraries",
    "href": "index.html#install-libraries",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "",
    "text": "!conda install -c conda-forge numpy pandas matplotlib seaborn requests pathlib BigQuery"
  },
  {
    "objectID": "index.html#import-libraries",
    "href": "index.html#import-libraries",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "",
    "text": "Show the code\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport importlib.util\nfrom pathlib import Path\nimport sys\nimport os\nimport requests\nimport io\n\nfrom dotenv import load_dotenv\nload_dotenv()\n\n\nTrue"
  },
  {
    "objectID": "index.html#helper-functions",
    "href": "index.html#helper-functions",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "",
    "text": "Show the code\ndef fetch_github(\n    url: str,\n    mode: str = \"private\",\n    token_env_var: str = \"GITHUB_TOKEN\"\n) -&gt; requests.Response:\n    \"\"\"\n    Fetch content from GitHub repositories.\n\n    Args:\n        url: GitHub raw URL (e.g., https://raw.githubusercontent.com/...)\n        mode: \"public\" for public repos, \"private\" for private repos requiring authentication\n        token_env_var: Name of environment variable containing GitHub token (default: GITHUB_TOKEN)\n\n    Returns:\n        requests.Response object\n\n    Raises:\n        ValueError: If token is missing for private mode or invalid mode\n        requests.HTTPError: If request fails\n    \"\"\"\n    # Validate mode\n    if mode not in [\"public\", \"private\"]:\n        raise ValueError(f\"mode must be 'public' or 'private', got '{mode}'\")\n\n    if mode == \"public\":\n        response = requests.get(url, timeout=30)\n    else:\n        token = os.getenv(token_env_var)\n        if not token:\n            raise ValueError(\n                f\"GitHub token not found in environment variable '{token_env_var}'. \"\n                f\"Check your .env file has: {token_env_var}=your_token_here\"\n            )\n\n        headers = {\n            'Authorization': f'token {token}',\n            'Accept': 'application/vnd.github.v3.raw'\n        }\n        response = requests.get(url, headers=headers, timeout=30)\n\n    response.raise_for_status()\n    return response"
  },
  {
    "objectID": "index.html#setup-bigquery",
    "href": "index.html#setup-bigquery",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "",
    "text": "Show the code\n# # Import global TDM functions from remote 'Resource' repo\n\n# Fetch and import BigQuery module\nresponse = fetch_github(\n    'https://raw.githubusercontent.com/WFRCAnalytics/Resources/refs/heads/master/2-Python/global-functions/BigQuery.py',\n    mode=\"public\"\n)\n\nBigQuery = importlib.util.module_from_spec(importlib.util.spec_from_loader('BigQuery', loader=None))\nexec(response.text, BigQuery.__dict__)\n\n# Initiatlize BigQuery Client\nclient = BigQuery.getBigQueryClient_Confidential2023UtahHTS()\n\n\npukar.bhandari\nC:/Users/Pukar.Bhandari/.private/confidential-2023-utah-hts-5fd7ddd219a7.json"
  },
  {
    "objectID": "index.html#uta-on-board-survey",
    "href": "index.html#uta-on-board-survey",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "2.1 UTA On-Board Survey",
    "text": "2.1 UTA On-Board Survey\n\n\nShow the code\n# Read Processed UTA On-Board Survey Data directly from GitHub repo\nresponse = fetch_github(\n    \"https://raw.githubusercontent.com/WFRCAnalytics/DATA-OBS-Prep-For-TDM/refs/heads/main/_output/UTA_OBS_2024_Processed.csv\",\n    mode = \"private\"\n)\n\ndf_obs_processed = pd.read_csv(io.StringIO(response.text))\ndf_obs_processed\n\n\nC:\\Users\\Pukar.Bhandari\\AppData\\Local\\Temp\\ipykernel_24696\\2568946126.py:7: DtypeWarning: Columns (8,24,32,37,54,132,137,174) have mixed types. Specify dtype option on import or set low_memory=False.\n  df_obs_processed = pd.read_csv(io.StringIO(response.text))\n\n\n\n\n\n\n\n\n\nID\nDATE_COMPLETED\nDATE_TYPE\nROUTE_DIRECTION_Code\nROUTE_DIRECTION\nROUTE_DIRECTION_Other\nHOME_ADDRESS_CITY\nHOME_ADDRESS_STATE\nHOME_ADDRESS_ZIP\nHOME_ADDRESS_LAT\n...\na_lat\na_lon\nFirstOn_lat\nFirstOn_lon\nLastOff_lat\nLastOff_lon\np_Stop_lat\np_Stop_lon\na_Stop_lat\na_Stop_lon\n\n\n\n\n0\n5948\n2/27/2024\nWeekday\nUTA_1_2_00\n2 200 SOUTH - TO U HOSPITAL\nNaN\nClearfield\nUT\n84015\n41.119565\n...\n40.759057\n-111.897381\n40.769221\n-111.898663\n41.118979\n-112.025922\n41.118979\n-112.025922\n40.769221\n-111.898663\n\n\n1\n6067\n2/27/2024\nWeekday\nUTA_1_47_00\n47 4700 SOUTH - TO W VALLEY CTL\nNaN\nWest Valley City\nUT\n84119\n40.689590\n...\n40.661882\n-111.899062\n40.660941\n-111.899443\n40.689384\n-111.967476\n40.689384\n-111.967476\n40.660941\n-111.899443\n\n\n2\n6069\n3/16/2024\nSaturday\nUTA_1_750_01\nFRONTRUNNER 750 - SOUTHBOUND\nNaN\nOgden\nUT\n84401\n41.186697\n...\n40.787558\n-111.985402\n41.188757\n-112.039378\n40.784356\n-111.982117\n41.188757\n-112.039378\n40.784356\n-111.982117\n\n\n3\n6073\n2/28/2024\nWeekday\nUTA_1_750_01\nFRONTRUNNER 750 - SOUTHBOUND\nNaN\nOgden\nUT\n84401\n41.236749\n...\n40.653134\n-111.910301\n41.188757\n-112.039378\n40.659758\n-111.896432\n41.188757\n-112.039378\n40.659758\n-111.896432\n\n\n4\n6077\n2/28/2024\nWeekday\nUTA_1_47_00\n47 4700 SOUTH - TO W VALLEY CTL\nNaN\nWest Valley City\nUT\n84119\n40.669687\n...\n40.684057\n-112.025854\n40.667711\n-111.961123\n40.681907\n-112.024041\n40.667711\n-111.961123\n40.681907\n-112.024041\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n13790\n30339\n4/26/2024\nWeekday\nUTA_1_704_01\nTRAX GREEN LINE 704 - TO AIRPORT\nNaN\nSalt Lake City\nUT\n84116\n40.772420\n...\n40.772426\n-111.915348\n40.771502\n-111.914486\n40.771536\n-111.945736\n40.771536\n-111.945736\n40.771502\n-111.914486\n\n\n13791\n30340\n4/26/2024\nWeekday\nUTA_1_704_00\nTRAX GREEN LINE 704 - TO WEST VALLEY\nNaN\nSalt Lake City\nUT\n84116\n40.771361\n...\n40.745704\n-111.873920\n40.771505\n-111.915361\n40.750058\n-111.896818\n40.771505\n-111.915361\n40.750058\n-111.896818\n\n\n13792\n30341\n4/26/2024\nWeekday\nUTA_1_704_00\nTRAX GREEN LINE 704 - TO WEST VALLEY\nNaN\nSalt Lake City\nUT\n84116\n40.773232\n...\n40.733521\n-111.879646\n40.771505\n-111.915361\n40.725345\n-111.877499\n40.771505\n-111.915361\n40.725345\n-111.877499\n\n\n13793\n1000002\n2/29/2024\nWeekday\nUTA_1_701_00\nTRAX BLUE LINE 701 - TO DRAPER\nNaN\nSalt Lake City\nUT\n84111\n40.751607\n...\n40.672049\n-111.944605\n40.755113\n-111.891095\n40.674859\n-111.943134\n40.755113\n-111.891095\n40.674859\n-111.943134\n\n\n13794\n1000004\n2/29/2024\nWeekday\nUTA_1_701_00\nTRAX BLUE LINE 701 - TO DRAPER\nNaN\nSalt Lake City\nUT\n84109\n40.722068\n...\n40.527251\n-111.857697\n40.725878\n-111.830935\n40.525496\n-111.858805\n40.725878\n-111.830935\n40.525496\n-111.858805\n\n\n\n\n13795 rows × 295 columns"
  },
  {
    "objectID": "index.html#household-travel-survey",
    "href": "index.html#household-travel-survey",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "2.2 Household Travel Survey",
    "text": "2.2 Household Travel Survey\n\n\nShow the code\n# Load Household-level data from 2023 Household Travel Survey\ndf_hts_hh23 = client.query(\n    \"SELECT * FROM \" + 'wfrc-modeling-data.prd_tdm_hts_2023.hh'\n).to_dataframe()\n\ndf_hts_hh23\n\n\n\n\n\n\n\n\n\nhh_id\nparticipation_group\nis_complete\nis_survey_complete\nnum_days_complete\nnum_days_survey_complete\nnum_days_complete_weekday\nnum_days_survey_complete_weekday\nnum_complete_mon\nnum_survey_complete_mon\n...\nnum_vehicles_4cat\nautosuf_wk\nlifecycle\nhh_children\nhh_adults\nhh_seniors\nhh_weight_col_enrol\nhh_weight\nhCO_TAZID_USTMv3\nhCO_TAZID_USTMv4\n\n\n\n\n0\n23472690\n9\n0\n1\n0\n7\n0\n5\n0\n1\n...\n3\nSufficient\n2\n1\n3\n0\nNaN\nNaN\n3087\n3087\n\n\n1\n23307416\n9\n0\n1\n0\n7\n0\n5\n0\n1\n...\n3\nSufficient\n2\n4\n3\n0\nNaN\nNaN\n3111\n3111\n\n\n2\n23317145\n9\n0\n1\n0\n7\n0\n5\n0\n1\n...\n2\nSufficient\n2\n2\n2\n0\nNaN\nNaN\n3231\n3231\n\n\n3\n23321176\n9\n0\n1\n0\n5\n0\n5\n0\n1\n...\n2\nSufficient\n3\n0\n0\n1\nNaN\nNaN\n3254\n3254\n\n\n4\n23345703\n9\n0\n1\n0\n1\n0\n1\n0\n0\n...\n2\nSufficient\n1\n0\n2\n0\nNaN\nNaN\n7001\n7001\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n11178\n23165031\n9\n1\n1\n7\n7\n5\n5\n1\n1\n...\n1\nSufficient\n1\n0\n1\n0\nNaN\n152.530720\n570407\n570407\n\n\n11179\n23046966\n9\n1\n1\n7\n7\n5\n5\n1\n1\n...\n1\nSufficient\n1\n0\n1\n0\nNaN\n98.388626\n570415\n570415\n\n\n11180\n23043011\n9\n1\n1\n7\n7\n5\n5\n1\n1\n...\n1\nSufficient\n1\n0\n2\n0\nNaN\n28.238022\n570417\n570417\n\n\n11181\n23376736\n9\n1\n1\n7\n7\n5\n5\n1\n1\n...\n1\nSufficient\n3\n0\n0\n1\nNaN\n135.715400\n570419\n570419\n\n\n11182\n23085912\n9\n1\n1\n7\n7\n5\n5\n1\n1\n...\n3\nSufficient\n3\n0\n0\n2\nNaN\n51.868473\n570419\n570419\n\n\n\n\n11183 rows × 123 columns\n\n\n\n\n\nShow the code\n# Load Person-level data from 2023 Household Travel Survey\ndf_hts_person23 = client.query(\n    \"SELECT * FROM \" + 'wfrc-modeling-data.prd_tdm_hts_2023.person'\n).to_dataframe()\n\ndf_hts_person23\n\n\n\n\n\n\n\n\n\nhh_id\nis_complete\nis_survey_complete\nnum_trips\nperson_id\nperson_num\nsurveyable\nis_participant\nrelationship\nage\n...\nlifegroup\nage_3cat\nadultJobs\nseniorJobs\nchildJobs\nperson_made_trips\ndrive_work_trips\ndrive_work_distance\nperson_weight_col_enrol\nperson_weight\n\n\n\n\n0\n23483793\n1\n1\n6\n2348379307\n7\n1\n1\n3\n6\n...\nadult\n2.0\n1\n0\n0\n1\n3\n75.313295\nNaN\n299.938780\n\n\n1\n23233210\n1\n1\n2\n2323321004\n4\n1\n1\n4\n4\n...\nNone\nNaN\n1\n0\n0\n1\n1\n12.921414\n0.0\nNaN\n\n\n2\n23252082\n1\n1\n2\n2325208202\n2\n1\n1\n3\n8\n...\nadult\n2.0\n1\n0\n0\n1\n1\n19.289847\nNaN\n599.010600\n\n\n3\n23085731\n1\n1\n18\n2308573101\n1\n1\n1\n0\n6\n...\nadult\n2.0\n1\n0\n0\n1\n0\n0.000000\nNaN\n278.218930\n\n\n4\n23238026\n1\n1\n5\n2323802603\n3\n1\n1\n3\n6\n...\nNone\nNaN\n1\n0\n0\n1\n1\n6.861802\n0.0\nNaN\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n13884\n23356285\n1\n1\n12\n2335628501\n1\n1\n1\n0\n8\n...\nadult\n2.0\n2\n0\n0\n1\n0\n0.000000\nNaN\n111.541504\n\n\n13885\n23346608\n1\n1\n0\n2334660803\n3\n1\n1\n2\n4\n...\nadult\n2.0\n1\n0\n0\n0\n0\n0.000000\nNaN\n83.666885\n\n\n13886\n23186778\n1\n1\n2\n2318677801\n1\n1\n1\n0\n5\n...\nadult\n2.0\n1\n0\n0\n1\n0\n0.000000\nNaN\n228.358470\n\n\n13887\n23371593\n1\n1\n36\n2337159303\n3\n1\n1\n3\n8\n...\nadult\n2.0\n1\n0\n0\n1\n0\n0.000000\nNaN\nNaN\n\n\n13888\n23350564\n1\n1\n52\n2335056401\n1\n1\n1\n0\n6\n...\nadult\n2.0\n1\n0\n0\n1\n0\n0.000000\nNaN\n184.878130\n\n\n\n\n29873 rows × 126 columns"
  },
  {
    "objectID": "index.html#on-board-survey",
    "href": "index.html#on-board-survey",
    "title": "Calculating the Mode Choice Calibration Parameters",
    "section": "4.1 On-Board Survey",
    "text": "4.1 On-Board Survey\n\nTrip Purposes\n\n\nShow the code\ndf_obs_processed[\"Purp5_text\"].value_counts() # Trip Purpose: HBW, HBO, HBC, NHB, HBSch\n\n\nPurp5_text\nHBW      5221\nHBO      4779\nHBC      2358\nNHB      1113\nHBSch     324\nName: count, dtype: int64\n\n\n\n\nPeak vs Off-Peak\n\n\nShow the code\ndf_obs_processed[\"PK_OK\"].value_counts() # Peak vs Off-Peak\n\n\nPK_OK\nOK    7656\nPK    6139\nName: count, dtype: int64\n\n\n\n\nMotorized vs Non-motorized\n\n\nShow the code\ndf_obs_processed[\"Ac_Mode_Model\"].value_counts() # Motorized (Drive) vs Non-motorized (Walk)\n\n\nAc_Mode_Model\nWalk     11016\nDrive     2779\nName: count, dtype: int64\n\n\n\n\nVehicle Ownership\n\n\nShow the code\ndf_obs_processed[\"Veh_Cat3p\"].value_counts() # Vehile Ownership Category: 0, 1, 2, 3+\n\n\nVeh_Cat3p\n0    4251\n1    3877\n2    3358\n3    2309\nName: count, dtype: int64"
  }
]