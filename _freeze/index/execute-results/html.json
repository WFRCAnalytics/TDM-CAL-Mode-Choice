{
  "hash": "2fe68792b9acfd8e081facbb08a7e3f7",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Calculating the Mode Choice Calibration Parameters\nsubtitle: Using Household Travel Survey and UTA On-Board Survey Data\ndescription: Lorem Ipsum\nauthor:\n - name: Pukar Bhandari\n   email: pukar.bhandari@wfrc.utah.gov\n   affiliation:\n     - name: Wasatch Front Regional Council\n       url: \"https://wfrc.utah.gov/\"\ndate: \"2025-11-03\"\n---\n\n# Setup Environment\n\nThis section prepares the Python environment with all necessary libraries and configurations. We'll import data manipulation libraries (pandas, numpy), and visualization tools (matplotlib, seaborn).\n\n## Install Libraries\n\n```python\n!conda install -c conda-forge numpy pandas matplotlib seaborn requests pathlib BigQuery\n```\n\n## Import Libraries\n\n::: {#c4b7c0c5 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport importlib.util\nfrom pathlib import Path\nimport sys\nimport os\nimport requests\nimport io\n\nfrom dotenv import load_dotenv\nload_dotenv()\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nTrue\n```\n:::\n:::\n\n\n## Environment Variables\n\n\n\n## Helper Functions\n\n::: {#2f86139e .cell execution_count=2}\n``` {.python .cell-code}\ndef fetch_github(\n    url: str,\n    mode: str = \"private\",\n    token_env_var: str = \"GITHUB_TOKEN\"\n) -> requests.Response:\n    \"\"\"\n    Fetch content from GitHub repositories.\n\n    Args:\n        url: GitHub raw URL (e.g., https://raw.githubusercontent.com/...)\n        mode: \"public\" for public repos, \"private\" for private repos requiring authentication\n        token_env_var: Name of environment variable containing GitHub token (default: GITHUB_TOKEN)\n\n    Returns:\n        requests.Response object\n\n    Raises:\n        ValueError: If token is missing for private mode or invalid mode\n        requests.HTTPError: If request fails\n    \"\"\"\n    # Validate mode\n    if mode not in [\"public\", \"private\"]:\n        raise ValueError(f\"mode must be 'public' or 'private', got '{mode}'\")\n\n    if mode == \"public\":\n        response = requests.get(url, timeout=30)\n    else:\n        token = os.getenv(token_env_var)\n        if not token:\n            raise ValueError(\n                f\"GitHub token not found in environment variable '{token_env_var}'. \"\n                f\"Check your .env file has: {token_env_var}=your_token_here\"\n            )\n\n        headers = {\n            'Authorization': f'token {token}',\n            'Accept': 'application/vnd.github.v3.raw'\n        }\n        response = requests.get(url, headers=headers, timeout=30)\n\n    response.raise_for_status()\n    return response\n```\n:::\n\n\n::: {#9f18e252 .cell execution_count=3}\n``` {.python .cell-code}\ndef calculate_categorical_shares(\n    df,\n    category_col,\n    weight_col='LINKED_WEIGHT',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition=None,\n    category_mapping=None,\n    prefix='share',\n    purpose_by_period=['HBW', 'HBO', 'NHB'],  # Only HBC and HBSch get daily\n    purpose_daily=['HBC', 'HBSch']  # NEW: Purposes that only get daily (no peak/off-peak)\n):\n    \"\"\"\n    Calculate weighted shares of categories within groups, ensuring they sum to 1.\n\n    Parameters:\n    -----------\n    df : DataFrame\n        Input dataframe\n    category_col : str\n        Column containing the categories to calculate shares for\n    weight_col : str\n        Column containing weights for each observation\n    group_cols : list\n        Columns to group by (e.g., vehicle ownership, purpose, peak/off-peak)\n    filter_condition : str or None\n        Optional pandas query string to filter data before calculation\n    category_mapping : dict or None\n        Optional mapping to rename/recode categories\n    prefix : str\n        Prefix for output column names\n    purpose_by_period : list\n        Purposes that should NOT get daily aggregates\n    purpose_daily : list\n        Purposes that ONLY get daily aggregates (no peak/off-peak breakdown)\n\n    Returns:\n    --------\n    DataFrame with shares in wide format\n    \"\"\"\n\n    # Apply filter and copy in one step\n    if filter_condition:\n        df_work = df.query(filter_condition).copy()\n    else:\n        df_work = df.copy()\n\n    # Apply category mapping if provided\n    if category_mapping:\n        df_work[category_col] = df_work[category_col].map(category_mapping)\n        # Remove unmapped values\n        df_work = df_work.dropna(subset=[category_col])\n\n    # Remove any NaN values in key columns\n    df_work = df_work.dropna(subset=[category_col, weight_col] + group_cols)\n\n    # Convert Veh_Cat3p to string format for consistency\n    df_work['Veh_Cat3p'] = df_work['Veh_Cat3p'].astype(str)\n    # Map 3 to 3+ for display\n    # df_work['Veh_Cat3p'] = df_work['Veh_Cat3p'].replace('3', '3+')\n\n    # Initialize results dictionary\n    results = {}\n\n    # Calculate weighted shares for each group combination (peak/off-peak)\n    # BUT skip purpose_daily\n    for veh in sorted(df_work['Veh_Cat3p'].unique()):\n        for purpose in sorted(df_work['Purp5_text'].unique()):\n            # Skip peak/off-peak for daily-only purposes\n            if purpose in purpose_daily:\n                continue\n\n            for peak in sorted(df_work['PK_OK'].unique()):\n                subset = df_work.query(\n                    f\"Veh_Cat3p == '{veh}' & Purp5_text == '{purpose}' & PK_OK == '{peak}'\"\n                )\n\n                if len(subset) > 0:\n                    # Calculate weighted counts by category\n                    weighted_counts = subset.groupby(category_col)[weight_col].sum()\n                    total_weight = subset[weight_col].sum()\n\n                    for cat, weighted_count in weighted_counts.items():\n                        var_name = f\"{prefix}_{cat}_{veh}veh\"\n                        if var_name not in results:\n                            results[var_name] = {}\n                        results[var_name][(purpose, peak)] = weighted_count / total_weight\n\n    # Calculate \"_all\" aggregates for peak/off-peak (excluding daily-only purposes)\n    for purpose in sorted(df_work['Purp5_text'].unique()):\n        # Skip peak/off-peak for daily-only purposes\n        if purpose in purpose_daily:\n            continue\n\n        for peak in sorted(df_work['PK_OK'].unique()):\n            subset = df_work.query(f\"Purp5_text == '{purpose}' & PK_OK == '{peak}'\")\n\n            if len(subset) > 0:\n                weighted_counts = subset.groupby(category_col)[weight_col].sum()\n                total_weight = subset[weight_col].sum()\n\n                for cat, weighted_count in weighted_counts.items():\n                    var_name = f\"{prefix}_{cat}_all\"\n                    if var_name not in results:\n                        results[var_name] = {}\n                    results[var_name][(purpose, peak)] = weighted_count / total_weight\n\n    # Calculate daily aggregates for specified purposes only\n    daily_purposes = [p for p in df_work['Purp5_text'].unique()\n                     if p not in purpose_by_period]\n\n    for purpose in daily_purposes:\n        subset = df_work.query(f\"Purp5_text == '{purpose}'\")\n\n        if len(subset) > 0:\n            # For each vehicle category\n            for veh in sorted(df_work['Veh_Cat3p'].unique()):\n                veh_subset = subset.query(f\"Veh_Cat3p == '{veh}'\")\n                if len(veh_subset) > 0:\n                    weighted_counts = veh_subset.groupby(category_col)[weight_col].sum()\n                    total_weight = veh_subset[weight_col].sum()\n\n                    for cat, weighted_count in weighted_counts.items():\n                        var_name = f\"{prefix}_{cat}_{veh}veh\"\n                        if var_name not in results:\n                            results[var_name] = {}\n                        results[var_name][(purpose, 'Daily')] = weighted_count / total_weight\n\n            # For \"all\" vehicle categories\n            weighted_counts = subset.groupby(category_col)[weight_col].sum()\n            total_weight = subset[weight_col].sum()\n\n            for cat, weighted_count in weighted_counts.items():\n                var_name = f\"{prefix}_{cat}_all\"\n                if var_name not in results:\n                    results[var_name] = {}\n                results[var_name][(purpose, 'Daily')] = weighted_count / total_weight\n\n    # Convert to DataFrame\n    df_result = pd.DataFrame(results).T\n    df_result.columns = pd.MultiIndex.from_tuples(df_result.columns)\n    df_result = df_result.fillna(0)\n\n    # Sort index\n    df_result = df_result.sort_index()\n\n    return df_result\n```\n:::\n\n\n::: {#eff86e48 .cell execution_count=4}\n``` {.python .cell-code}\n# Verify categorical shares sum to 1.0000\ndef verify_shares(df_shares, tolerance=0.01):\n    \"\"\"\n    Verify that shares sum to approximately 1 within each vehicle category group.\n\n    Now that we have separate rows for each vehicle ownership category (0veh, 1veh, 2veh, 3+veh, all),\n    we need to verify that shares sum to 1 within each vehicle category separately.\n    \"\"\"\n    print(\"=== Verifying Share Sums ===\\n\")\n\n    # Extract vehicle categories from index\n    # Assuming format: calib_share_{category}_{veh_category}\n    vehicle_categories = df_shares.index.str.extract(r'_(\\d\\+?veh|all)$')[0].unique()\n\n    print(f\"Vehicle categories found: {sorted(vehicle_categories)}\\n\")\n\n    all_good = True\n    issues = []\n\n    # Check each vehicle category separately\n    for veh_cat in sorted(vehicle_categories):\n        # Filter rows for this vehicle category\n        mask = df_shares.index.str.endswith(f'_{veh_cat}')\n        df_veh = df_shares[mask]\n\n        print(f\"--- Checking {veh_cat} ({len(df_veh)} categories) ---\")\n\n        # Check sums for each column within this vehicle category\n        veh_issues = []\n        for col in df_veh.columns:\n            col_sum = df_veh[col].sum()\n\n            if abs(col_sum - 1.0) > tolerance:\n                all_good = False\n                veh_issues.append((col, col_sum))\n\n        if not veh_issues:\n            print(f\"  ‚úÖ All shares sum to 1.0 for {veh_cat}\")\n        else:\n            print(f\"  ‚ö†Ô∏è  {len(veh_issues)} columns don't sum to 1.0 for {veh_cat}:\")\n            for col, sum_val in veh_issues[:5]:  # Show first 5\n                print(f\"     {col}: {sum_val:.4f}\")\n            if len(veh_issues) > 5:\n                print(f\"     ... and {len(veh_issues) - 5} more\")\n            issues.extend([(veh_cat, col, sum_val) for col, sum_val in veh_issues])\n        print()\n\n    print(f\"{'='*60}\")\n    if all_good:\n        print(\"‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\")\n    else:\n        print(f\"‚ö†Ô∏è  WARNING: {len(issues)} total column/vehicle combinations don't sum to 1.0\")\n\n    print(f\"\\nTotal columns: {len(df_shares.columns)}\")\n    print(f\"Total vehicle categories: {len(vehicle_categories)}\")\n    print(f\"Total combinations: {len(df_shares.columns) * len(vehicle_categories)}\")\n\n    # Return sums by vehicle category\n    return {veh_cat: df_shares[df_shares.index.str.endswith(f'_{veh_cat}')].sum(axis=0)\n            for veh_cat in sorted(vehicle_categories)}\n```\n:::\n\n\n## Setup BigQuery\n\n\n\n::: {#39053ef1 .cell execution_count=6}\n``` {.python .cell-code}\n# # Import global TDM functions from remote 'Resource' repo\n\n# Fetch and import BigQuery module\nresponse = fetch_github(\n    'https://raw.githubusercontent.com/WFRCAnalytics/Resources/refs/heads/master/2-Python/global-functions/BigQuery.py',\n    mode=\"public\"\n)\n\nBigQuery = importlib.util.module_from_spec(importlib.util.spec_from_loader('BigQuery', loader=None))\nexec(response.text, BigQuery.__dict__)\n\n# Initiatlize BigQuery Client\nclient = BigQuery.getBigQueryClient_Confidential2023UtahHTS()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npukar.bhandari\nC:/Users/Pukar.Bhandari/.private/confidential-2023-utah-hts-5fd7ddd219a7.json\n```\n:::\n:::\n\n\n# Load Data\n\n## UTA On-Board Survey\n\n::: {#1d171c1c .cell execution_count=7}\n``` {.python .cell-code}\n# Read Linked UTA On-Board Survey Data directly from GitHub repo\nresponse = fetch_github(\n    \"https://raw.githubusercontent.com/WFRCAnalytics/DATA-OBS-Prep-For-TDM/refs/heads/main/_output/UTA_OBS_2024_Linked.csv\",\n    mode = \"private\"\n)\n\ndf_obs_linked = pd.read_csv(io.StringIO(response.text))\ndf_obs_linked\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\Pukar.Bhandari\\AppData\\Local\\Temp\\ipykernel_28684\\4156658631.py:7: DtypeWarning:\n\nColumns (8,24,32,37,54,132,137,174) have mixed types. Specify dtype option on import or set low_memory=False.\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ID</th>\n      <th>DATE_COMPLETED</th>\n      <th>DATE_TYPE</th>\n      <th>ROUTE_DIRECTION_Code</th>\n      <th>ROUTE_DIRECTION</th>\n      <th>ROUTE_DIRECTION_Other</th>\n      <th>HOME_ADDRESS_CITY</th>\n      <th>HOME_ADDRESS_STATE</th>\n      <th>HOME_ADDRESS_ZIP</th>\n      <th>HOME_ADDRESS_LAT</th>\n      <th>...</th>\n      <th>p_Stop_lat</th>\n      <th>p_Stop_lon</th>\n      <th>a_Stop_lat</th>\n      <th>a_Stop_lon</th>\n      <th>p_Stop_N</th>\n      <th>a_Stop_N</th>\n      <th>access_dist</th>\n      <th>access_time</th>\n      <th>egress_dist</th>\n      <th>egress_time</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>5948</td>\n      <td>2/27/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_2_00</td>\n      <td>2 200 SOUTH - TO U HOSPITAL</td>\n      <td>NaN</td>\n      <td>Clearfield</td>\n      <td>UT</td>\n      <td>84015</td>\n      <td>41.119565</td>\n      <td>...</td>\n      <td>41.118979</td>\n      <td>-112.025922</td>\n      <td>40.769221</td>\n      <td>-111.898663</td>\n      <td>27702.0</td>\n      <td>25493.0</td>\n      <td>0.37</td>\n      <td>8.79</td>\n      <td>0.68</td>\n      <td>16.27</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>6067</td>\n      <td>2/27/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_47_00</td>\n      <td>47 4700 SOUTH - TO W VALLEY CTL</td>\n      <td>NaN</td>\n      <td>West Valley City</td>\n      <td>UT</td>\n      <td>84119</td>\n      <td>40.689590</td>\n      <td>...</td>\n      <td>40.689384</td>\n      <td>-111.967476</td>\n      <td>40.660941</td>\n      <td>-111.899443</td>\n      <td>23195.0</td>\n      <td>23685.0</td>\n      <td>0.56</td>\n      <td>13.53</td>\n      <td>0.24</td>\n      <td>5.70</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>6069</td>\n      <td>3/16/2024</td>\n      <td>Saturday</td>\n      <td>UTA_1_750_01</td>\n      <td>FRONTRUNNER 750 - SOUTHBOUND</td>\n      <td>NaN</td>\n      <td>Ogden</td>\n      <td>UT</td>\n      <td>84401</td>\n      <td>41.186697</td>\n      <td>...</td>\n      <td>41.188757</td>\n      <td>-112.039378</td>\n      <td>40.784356</td>\n      <td>-111.982117</td>\n      <td>10042.0</td>\n      <td>15093.0</td>\n      <td>1.15</td>\n      <td>2.76</td>\n      <td>0.20</td>\n      <td>4.89</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>6073</td>\n      <td>2/28/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_750_01</td>\n      <td>FRONTRUNNER 750 - SOUTHBOUND</td>\n      <td>NaN</td>\n      <td>Ogden</td>\n      <td>UT</td>\n      <td>84401</td>\n      <td>41.236749</td>\n      <td>...</td>\n      <td>41.188757</td>\n      <td>-112.039378</td>\n      <td>40.659758</td>\n      <td>-111.896432</td>\n      <td>10042.0</td>\n      <td>10016.0</td>\n      <td>4.17</td>\n      <td>8.22</td>\n      <td>1.37</td>\n      <td>3.29</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>6077</td>\n      <td>2/28/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_47_00</td>\n      <td>47 4700 SOUTH - TO W VALLEY CTL</td>\n      <td>NaN</td>\n      <td>West Valley City</td>\n      <td>UT</td>\n      <td>84119</td>\n      <td>40.669687</td>\n      <td>...</td>\n      <td>40.667711</td>\n      <td>-111.961123</td>\n      <td>40.681907</td>\n      <td>-112.024041</td>\n      <td>22922.0</td>\n      <td>22421.0</td>\n      <td>0.25</td>\n      <td>6.00</td>\n      <td>0.49</td>\n      <td>11.88</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>13790</th>\n      <td>30339</td>\n      <td>4/26/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_704_01</td>\n      <td>TRAX GREEN LINE 704 - TO AIRPORT</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84116</td>\n      <td>40.772420</td>\n      <td>...</td>\n      <td>40.771536</td>\n      <td>-111.945736</td>\n      <td>40.771502</td>\n      <td>-111.914486</td>\n      <td>15101.0</td>\n      <td>15122.0</td>\n      <td>0.31</td>\n      <td>7.53</td>\n      <td>0.17</td>\n      <td>4.07</td>\n    </tr>\n    <tr>\n      <th>13791</th>\n      <td>30340</td>\n      <td>4/26/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_704_00</td>\n      <td>TRAX GREEN LINE 704 - TO WEST VALLEY</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84116</td>\n      <td>40.771361</td>\n      <td>...</td>\n      <td>40.771505</td>\n      <td>-111.915361</td>\n      <td>40.750058</td>\n      <td>-111.896818</td>\n      <td>15122.0</td>\n      <td>15109.0</td>\n      <td>0.46</td>\n      <td>11.00</td>\n      <td>1.21</td>\n      <td>29.10</td>\n    </tr>\n    <tr>\n      <th>13792</th>\n      <td>30341</td>\n      <td>4/26/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_704_00</td>\n      <td>TRAX GREEN LINE 704 - TO WEST VALLEY</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84116</td>\n      <td>40.773232</td>\n      <td>...</td>\n      <td>40.771505</td>\n      <td>-111.915361</td>\n      <td>40.725345</td>\n      <td>-111.877499</td>\n      <td>15122.0</td>\n      <td>24968.0</td>\n      <td>0.17</td>\n      <td>4.07</td>\n      <td>0.86</td>\n      <td>20.68</td>\n    </tr>\n    <tr>\n      <th>13793</th>\n      <td>1000002</td>\n      <td>2/29/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_701_00</td>\n      <td>TRAX BLUE LINE 701 - TO DRAPER</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84111</td>\n      <td>40.751607</td>\n      <td>...</td>\n      <td>40.755113</td>\n      <td>-111.891095</td>\n      <td>40.674859</td>\n      <td>-111.943134</td>\n      <td>15123.0</td>\n      <td>23342.0</td>\n      <td>0.33</td>\n      <td>7.95</td>\n      <td>0.29</td>\n      <td>7.02</td>\n    </tr>\n    <tr>\n      <th>13794</th>\n      <td>1000004</td>\n      <td>2/29/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_701_00</td>\n      <td>TRAX BLUE LINE 701 - TO DRAPER</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84109</td>\n      <td>40.722068</td>\n      <td>...</td>\n      <td>40.725878</td>\n      <td>-111.830935</td>\n      <td>40.525496</td>\n      <td>-111.858805</td>\n      <td>25663.0</td>\n      <td>15041.0</td>\n      <td>0.79</td>\n      <td>18.85</td>\n      <td>0.19</td>\n      <td>4.44</td>\n    </tr>\n  </tbody>\n</table>\n<p>13795 rows √ó 303 columns</p>\n</div>\n```\n:::\n:::\n\n\n## Household Travel Survey\n\n::: {#8e93f37c .cell execution_count=8}\n``` {.python .cell-code}\n# Load Linked Trips data from 2023 Household Travel Survey\ndf_hts_linked = client.query(\n    \"SELECT hh_id, PURP7_t, depart_per, model_trip_mode_WFv10, trip_weight FROM \" + 'wfrc-modeling-data.prd_tdm_hts_2023.trip_linked'\n).to_dataframe()\n\ndf_hts_linked\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>hh_id</th>\n      <th>PURP7_t</th>\n      <th>depart_per</th>\n      <th>model_trip_mode_WFv10</th>\n      <th>trip_weight</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>23009497</td>\n      <td>HBC</td>\n      <td>AM</td>\n      <td>auto-occ2</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>23153049</td>\n      <td>HBC</td>\n      <td>AM</td>\n      <td>drive-to-transit</td>\n      <td>29.247902</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>23183233</td>\n      <td>HBC</td>\n      <td>AM</td>\n      <td>walk-to-transit</td>\n      <td>8.413385</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>23003621</td>\n      <td>HBOth</td>\n      <td>AM</td>\n      <td>auto-occ3p</td>\n      <td>100.258156</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>23011441</td>\n      <td>HBOth</td>\n      <td>AM</td>\n      <td>bike</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>232446</th>\n      <td>23463507</td>\n      <td>NHBW</td>\n      <td>PM</td>\n      <td>auto-sov</td>\n      <td>16.681071</td>\n    </tr>\n    <tr>\n      <th>232447</th>\n      <td>23478596</td>\n      <td>NHBW</td>\n      <td>PM</td>\n      <td>auto-occ3p</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>232448</th>\n      <td>23481933</td>\n      <td>NHBW</td>\n      <td>PM</td>\n      <td>auto-sov</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>232449</th>\n      <td>23482195</td>\n      <td>NHBW</td>\n      <td>PM</td>\n      <td>walk</td>\n      <td>68.644470</td>\n    </tr>\n    <tr>\n      <th>232450</th>\n      <td>23494735</td>\n      <td>NHBW</td>\n      <td>PM</td>\n      <td>auto-sov</td>\n      <td>0.000000</td>\n    </tr>\n  </tbody>\n</table>\n<p>232451 rows √ó 5 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#832c88d7 .cell execution_count=9}\n``` {.python .cell-code}\n# Load Household data from 2023 Household Travel Survey\ndf_hts_hh = client.query(\n    \"SELECT hh_id, num_vehicles_4cat FROM \" + 'wfrc-modeling-data.prd_tdm_hts_2023.hh'\n).to_dataframe()\n\ndf_hts_hh\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>hh_id</th>\n      <th>num_vehicles_4cat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>23472690</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>23307416</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>23317145</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>23321176</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>23345703</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>11178</th>\n      <td>23165031</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>11179</th>\n      <td>23046966</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>11180</th>\n      <td>23043011</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>11181</th>\n      <td>23376736</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>11182</th>\n      <td>23085912</td>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>\n<p>11183 rows √ó 2 columns</p>\n</div>\n```\n:::\n:::\n\n\n# Understanding Mode Hierarchy\n\n```{mermaid}\nflowchart LR\n  T[\"üö¶ Total Trips\"]\n\n  %% Top-level split\n  T --> M[\"Motorized\"]\n  T --> NM[\"Non-motorized\"]\n\n  %% Motorized branch\n  subgraph S1[\"üöó Motorized Transportation\"]\n    direction TB\n    M --> A[\"Auto\"]\n    M --> TR[\"Transit\"]\n\n    %% Auto\n    A --> DA[\"Drive alone\"]\n    A --> SR[\"Shared ride\"]\n    SR --> SR2[\"SR2<br/><i>2 people</i>\"]\n    SR --> SR3[\"SR3<br/><i>3+ people</i>\"]\n\n    %% Transit (two complementary views)\n    subgraph S1a[\"üöå Transit ‚Äì By Service Type\"]\n      direction TB\n      TR --> TM[\"By service type\"]\n      TM --> LB[\"Local bus\"]\n      TM --> CB[\"Core bus\"]\n      TM --> EB[\"Express bus\"]\n      TM --> LRT[\"LRT<br/><i>light rail</i>\"]\n      TM --> CRT[\"CRT<br/><i>commuter rail</i>\"]\n      TM --> BRT[\"BRT<br/><i>bus rapid</i>\"]\n    end\n\n    subgraph S1b[\"üö∂üöó Transit ‚Äì By Access Type\"]\n      direction TB\n      TR --> TA[\"By access type\"]\n\n      %% Walk-to-transit\n      TA --> WTT[\"üö∂ Walk-to-transit\"]\n      WTT --> WLB[\"Walk ‚Üí Local bus\"]\n      WTT --> WCB[\"Walk ‚Üí Core bus\"]\n      WTT --> WEB[\"Walk ‚Üí Express bus\"]\n      WTT --> WLRT[\"Walk ‚Üí LRT\"]\n      WTT --> WCRT[\"Walk ‚Üí CRT\"]\n      WTT --> WBRT[\"Walk ‚Üí BRT\"]\n\n      %% Drive-to-transit\n      TA --> DTT[\"üöó Drive-to-transit\"]\n      DTT --> DLB[\"Drive ‚Üí Local bus\"]\n      DTT --> DCB[\"Drive ‚Üí Core bus\"]\n      DTT --> DEB[\"Drive ‚Üí Express bus\"]\n      DTT --> DLRT[\"Drive ‚Üí LRT\"]\n      DTT --> DCRT[\"Drive ‚Üí CRT\"]\n      DTT --> DBRT[\"Drive ‚Üí BRT\"]\n    end\n  end\n\n  %% Non-motorized branch\n  subgraph S2[\"üö∂ Non-motorized Transportation\"]\n    direction TB\n    NM --> WALK[\"Walk\"]\n    NM --> BIKE[\"Bike\"]\n  end\n\n  %% Styling\n  classDef rootNode fill:#2c3e50,stroke:#34495e,stroke-width:3px,color:#fff,font-weight:bold,font-size:16px\n  classDef motorizedNode fill:#3498db,stroke:#2980b9,stroke-width:2px,color:#fff,font-weight:bold\n  classDef nonMotorizedNode fill:#27ae60,stroke:#229954,stroke-width:2px,color:#fff,font-weight:bold\n  classDef autoNode fill:#e67e22,stroke:#d35400,stroke-width:2px,color:#fff\n  classDef transitNode fill:#9b59b6,stroke:#8e44ad,stroke-width:2px,color:#fff\n  classDef walkTransitNode fill:#1abc9c,stroke:#16a085,stroke-width:2px,color:#fff\n  classDef driveTransitNode fill:#e74c3c,stroke:#c0392b,stroke-width:2px,color:#fff\n  classDef leafNode fill:#ecf0f1,stroke:#95a5a6,stroke-width:1px,color:#2c3e50\n  classDef subgraphStyle fill:#f8f9fa,stroke:#dee2e6,stroke-width:2px\n\n  class T rootNode\n  class M motorizedNode\n  class NM nonMotorizedNode\n  class A,DA,SR,SR2,SR3 autoNode\n  class TR,TM,TA transitNode\n  class WTT,WLB,WCB,WEB,WLRT,WCRT,WBRT walkTransitNode\n  class DTT,DLB,DCB,DEB,DLRT,DCRT,DBRT driveTransitNode\n  class LB,CB,EB,LRT,CRT,BRT,WALK,BIKE leafNode\n```\n\n\n# Identify Variable of Interest\n\n## On-Board Survey\n\n::: {#21056612 .cell execution_count=10}\n``` {.python .cell-code}\ndf_obs_linked[[\n    \"Linked_Mode_txt\", # Linked Mode: MT = MicroTransit (dont need), LCL = local bus, COR = Core Bus, EXP = Express Bus, LRT = Light Rail Transit (TRAX), CRT = Commuter Rail Transit (FrontRunner), BRT = Bus Rapid Transit (OVX, UVX)\n    \"Purp5_text\", # Trip Purpose: HBW = Home-based Work, HBO = Home-based Other, HBC = Home-based College, NHB = Non-home based, HBSch = Home-based School\n    \"PK_OK\", # Peak vs OffPeak\n    \"Veh_Cat3p\", # Vehicle Ownership: 0 = 0 Vehicle Household, 1 = 1 Vehicle Household, 2 = 2 Vehicle Household, 3 = 3+ Vehicle Household\n    \"Mode_Fin\", # Current Mode: 1 = MT = MicroTransit (Dont need),  4 = LCL = local bus, 5 = COR = Core Bus, 6 = EXP = Express Bus, 7 = LRT = Light Rail Transit (TRAX), 8 = CRT = Commuter Rail Transit, 9 = BRT = Bus Rapid Transit (OVX, UVX)\n    \"Ac_Mode_Model\", # Access Mode to Transit: Walk (Walk to Transit), Drive (Drive to Transit)\n]]\n```\n:::\n\n\n# Process HTS to get needed vars\n\nOBS has already been processed in OBS Prep repo. So, this section will only Process HTS data to get needed columns.\n\n## Purpose (5-category)\n\n::: {#7704f8d4 .cell execution_count=11}\n``` {.python .cell-code}\npurpose_mapping = {\n    'HBOth' : 'HBO',\n    'NHBNW' : 'NHB',\n    'HBW'   : 'HBW',\n    'NHBW'  : 'NHB',\n    'HBShp' : 'HBO',\n    'HBSch' : 'HBSch',\n    'HBC'   : 'HBC'\n}\n\ndf_hts_linked['Purp5_text'] = df_hts_linked['PURP7_t'].map(purpose_mapping)\n```\n:::\n\n\n## Vehicle Ownership\n\n::: {#078363c6 .cell execution_count=12}\n``` {.python .cell-code}\n# Join household data to linked trips data\ndf_hts_linked = df_hts_linked.merge(\n    df_hts_hh.rename(columns={'num_vehicles_4cat': 'Veh_Cat3p'}),\n    on='hh_id',\n    how='left'  # Keep all trips, even if household data is missing\n)\n\n# Rename the vehicle ownership column to match the OBS data\ndf_hts_linked = df_hts_linked.rename(columns={'num_vehicles_4cat': 'Veh_Cat3p'})\n```\n:::\n\n\n## Peak - Offpeak\n\n::: {#7a61aa71 .cell execution_count=13}\n``` {.python .cell-code}\ndf_hts_linked['PK_OK'] = np.where(\n    df_hts_linked[\"depart_per\"].isin([\"AM\", \"PM\"]),\n    \"PK\",\n    \"OK\"\n)\n```\n:::\n\n\n# Data Exploration\n\n## Motorized vs Nonmotorized\n\n::: {#ccbc32aa .cell execution_count=14}\n``` {.python .cell-code}\n(\n    df_hts_linked[\n        (df_hts_linked['model_trip_mode_WFv10'].isin(\n            [\"auto-sov\", \"auto-occ2\", \"auto-occ3p\", \"walk-to-transit\",\n             \"drive-to-transit\", \"walk\", \"bike\"]\n        )) &\n        (df_hts_linked['Purp5_text'] == 'HBW')\n    ]\n    .assign(motorized_category=lambda x: x['model_trip_mode_WFv10'].map({\n        'auto-sov'         : 'motor',\n        'auto-occ2'        : 'motor',\n        'auto-occ3p'       : 'motor',\n        'walk-to-transit'  : 'motor',\n        'drive-to-transit' : 'motor',\n        'walk'             : 'nonmotor',\n        'bike'             : 'nonmotor'\n    }))\n    .groupby('motorized_category')['trip_weight']\n    .sum()\n    .pipe(lambda x: (x / x.sum() * 100).round(2))\n)\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\nmotorized_category\nmotor       97.03\nnonmotor     2.97\nName: trip_weight, dtype: float64\n```\n:::\n:::\n\n\n## HTS vs OBS Transit Trips\n\n### Filter for Transit Trips\n\n::: {#198dcc24 .cell execution_count=15}\n``` {.python .cell-code}\n# Identify transit trips in HTS\nhts_transit = df_hts_linked[\n    df_hts_linked['model_trip_mode_WFv10'].isin(['walk-to-transit', 'drive-to-transit'])\n].copy()\n\n# Filter out microtransit\nobs_transit = df_obs_linked[df_obs_linked['Linked_Mode_txt'] != 'MT'].copy()\n```\n:::\n\n\n### By access mode\n\n::: {#a059628d .cell execution_count=16}\n``` {.python .cell-code}\nhts_by_access = hts_transit.groupby('model_trip_mode_WFv10')['trip_weight'].sum()\nhts_by_access\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\nmodel_trip_mode_WFv10\ndrive-to-transit     34844.620753\nwalk-to-transit     106748.298633\nName: trip_weight, dtype: float64\n```\n:::\n:::\n\n\n::: {#7c9e0f33 .cell execution_count=17}\n``` {.python .cell-code}\nif 'Ac_Mode2_Model' in obs_transit.columns:\n    obs_by_access = obs_transit.groupby('Ac_Mode2_Model')['LINKED_WEIGHT'].sum().sort_index()\n\nobs_by_access\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\nAc_Mode2_Model\nDrive    16854.909795\nWalk     75057.146738\nName: LINKED_WEIGHT, dtype: float64\n```\n:::\n:::\n\n\n### By purpose\n\n::: {#036052bf .cell execution_count=18}\n``` {.python .cell-code}\nhts_by_purpose = hts_transit.groupby('Purp5_text')['trip_weight'].sum().sort_index()\nhts_by_purpose\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```\nPurp5_text\nHBC       9625.364706\nHBO      57055.318544\nHBSch     4709.043372\nHBW      41885.316622\nNHB      28317.876141\nName: trip_weight, dtype: float64\n```\n:::\n:::\n\n\n::: {#f4858474 .cell execution_count=19}\n``` {.python .cell-code}\nobs_by_purpose = obs_transit.groupby('Purp5_text')['LINKED_WEIGHT'].sum().sort_index()\nobs_by_purpose\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\nPurp5_text\nHBC      17360.337763\nHBO      29495.641594\nHBSch     2506.365679\nHBW      34348.705422\nNHB       8201.006075\nName: LINKED_WEIGHT, dtype: float64\n```\n:::\n:::\n\n\n### By vehicle ownership\n\n::: {#c76dd751 .cell execution_count=20}\n``` {.python .cell-code}\nhts_by_veh = hts_transit.groupby('Veh_Cat3p')['trip_weight'].sum().sort_index()\nhts_by_veh\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\nVeh_Cat3p\n0    41442.964546\n1    39084.528933\n2    37437.608191\n3    23627.817715\nName: trip_weight, dtype: float64\n```\n:::\n:::\n\n\n::: {#341221bd .cell execution_count=21}\n``` {.python .cell-code}\nobs_by_veh = obs_transit.groupby('Veh_Cat3p')['LINKED_WEIGHT'].sum().sort_index()\nobs_by_veh\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```\nVeh_Cat3p\n0    27945.142654\n1    26587.638318\n2    22481.347636\n3    14897.927926\nName: LINKED_WEIGHT, dtype: float64\n```\n:::\n:::\n\n\n### By period\n\n::: {#a7b388fa .cell execution_count=22}\n``` {.python .cell-code}\nhts_by_period = hts_transit.groupby('PK_OK')['trip_weight'].sum().sort_index()\nhts_by_period\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\nPK_OK\nOK    75439.954455\nPK    66152.964930\nName: trip_weight, dtype: float64\n```\n:::\n:::\n\n\n::: {#08d22318 .cell execution_count=23}\n``` {.python .cell-code}\nobs_by_period = obs_transit.groupby('PK_OK')['LINKED_WEIGHT'].sum().sort_index()\nobs_by_period\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\nPK_OK\nOK    54189.703255\nPK    37722.353279\nName: LINKED_WEIGHT, dtype: float64\n```\n:::\n:::\n\n\n### Summary\n\n::: {#78924ba4 .cell execution_count=24}\n``` {.python .cell-code}\nprint(\"\\n\" + \"=\" * 80)\nprint(\"3. COMPARISON SUMMARY\")\nprint(\"=\" * 80)\n\nhts_total = hts_transit['trip_weight'].sum()\nobs_total = obs_transit['LINKED_WEIGHT'].sum()\nratio = obs_total / hts_total if hts_total > 0 else 0\n\nprint(f\"\\nHTS Daily Transit Trips:  {hts_total:>15,.1f}\")\nprint(f\"OBS Daily Transit Trips:  {obs_total:>15,.1f}\")\nprint(f\"{'‚îÄ' * 45}\")\nprint(f\"Ratio (OBS/HTS):          {ratio:>15.2f}x\")\nprint(f\"Difference:               {obs_total - hts_total:>15,.1f}\")\nprint(f\"% Difference:             {((obs_total/hts_total - 1) * 100):>15.1f}%\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n================================================================================\n3. COMPARISON SUMMARY\n================================================================================\n\nHTS Daily Transit Trips:        141,592.9\nOBS Daily Transit Trips:         91,912.1\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nRatio (OBS/HTS):                     0.65x\nDifference:                     -49,680.9\n% Difference:                       -35.1%\n```\n:::\n:::\n\n\n::: {#22f936e6 .cell execution_count=25}\n``` {.python .cell-code}\nprint(\"\\n\" + \"=\" * 80)\nprint(\"4. DETAILED COMPARISON BY PURPOSE & PERIOD\")\nprint(\"=\" * 80)\n\n# Create comparison dataframe\ncomparison_data = []\n\nfor purpose in sorted(df_hts_linked['Purp5_text'].dropna().unique()):\n    for period in ['PK', 'OK']:\n        hts_val = hts_transit[\n            (hts_transit['Purp5_text'] == purpose) &\n            (hts_transit['PK_OK'] == period)\n        ]['trip_weight'].sum()\n\n        obs_val = obs_transit[\n            (obs_transit['Purp5_text'] == purpose) &\n            (obs_transit['PK_OK'] == period)\n        ]['LINKED_WEIGHT'].sum()\n\n        comparison_data.append({\n            'Purpose': purpose,\n            'Period': period,\n            'HTS_Trips': hts_val,\n            'OBS_Trips': obs_val,\n            'Ratio_OBS_HTS': obs_val / hts_val if hts_val > 0 else np.nan,\n            'Difference': obs_val - hts_val\n        })\n\ndf_comparison = pd.DataFrame(comparison_data)\ndf_comparison = df_comparison.sort_values(['Purpose', 'Period'])\n\nprint(\"\\n\")\nprint(df_comparison.to_string(index=False, float_format=lambda x: f'{x:,.2f}'))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n================================================================================\n4. DETAILED COMPARISON BY PURPOSE & PERIOD\n================================================================================\n\n\nPurpose Period  HTS_Trips  OBS_Trips  Ratio_OBS_HTS  Difference\n    HBC     OK   5,617.11  10,731.26           1.91    5,114.15\n    HBC     PK   4,008.25   6,629.08           1.65    2,620.83\n    HBO     OK  33,731.77  19,919.48           0.59  -13,812.28\n    HBO     PK  23,323.55   9,576.16           0.41  -13,747.40\n  HBSch     OK   1,472.00   1,289.22           0.88     -182.78\n  HBSch     PK   3,237.04   1,217.15           0.38   -2,019.90\n    HBW     OK  16,938.12  16,513.66           0.97     -424.46\n    HBW     PK  24,947.20  17,835.04           0.71   -7,112.15\n    NHB     OK  17,680.95   5,736.08           0.32  -11,944.88\n    NHB     PK  10,636.92   2,464.93           0.23   -8,171.99\n```\n:::\n:::\n\n\n# Trips: Motorized vs Non-motorized\n\n::: {#58a9b72c .cell execution_count=26}\n``` {.python .cell-code}\n# 1. All Trips: Motorized vs Non-motorized\nprint(\"\\n\" + \"=\" * 60)\nprint(\"1. ALL TRIPS: MOTORIZED VS NON-MOTORIZED\")\nprint(\"=\" * 60)\n\nall_trips_mapping = {\n    'auto-sov'         : 'motor',\n    'auto-occ2'        : 'motor',\n    'auto-occ3p'       : 'motor',\n    'walk-to-transit'  : 'motor',\n    'drive-to-transit' : 'motor',\n    'walk'             : 'nonmotor',\n    'bike'             : 'nonmotor'\n}\n\ndf_alltrips_cat = calculate_categorical_shares(\n    df_hts_linked,\n    category_col='model_trip_mode_WFv10',\n    weight_col='trip_weight',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='model_trip_mode_WFv10 in [\"auto-sov\", \"auto-occ2\", \"auto-occ3p\", \"walk-to-transit\", \"drive-to-transit\", \"walk\", \"bike\"]',\n    category_mapping=all_trips_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_alltrips_cat.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_alltrips_cat.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_alltrips_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n1. ALL TRIPS: MOTORIZED VS NON-MOTORIZED\n============================================================\n\nShape: (10, 8)\n\nFirst few rows:\n                                HBO                 HBW                 NHB  \\\n                                 OK        PK        OK        PK        OK   \ncalib_share_motor_0veh     0.612888  0.740061  0.637117  0.633910  0.617760   \ncalib_share_motor_1veh     0.915128  0.907601  0.961417  0.953408  0.916932   \ncalib_share_motor_2veh     0.928887  0.925552  0.964561  0.976813  0.917386   \ncalib_share_motor_3veh     0.960142  0.962816  0.982516  0.987530  0.934854   \ncalib_share_motor_all      0.933325  0.934203  0.963215  0.975479  0.920207   \ncalib_share_nonmotor_0veh  0.387112  0.259939  0.362883  0.366090  0.382240   \ncalib_share_nonmotor_1veh  0.084872  0.092399  0.038583  0.046592  0.083068   \ncalib_share_nonmotor_2veh  0.071113  0.074448  0.035439  0.023187  0.082614   \ncalib_share_nonmotor_3veh  0.039858  0.037184  0.017484  0.012470  0.065146   \ncalib_share_nonmotor_all   0.066675  0.065797  0.036785  0.024521  0.079793   \n\n                                          HBC     HBSch  \n                                 PK     Daily     Daily  \ncalib_share_motor_0veh     0.640455  0.237016  0.147109  \ncalib_share_motor_1veh     0.911869  0.760623  0.767879  \ncalib_share_motor_2veh     0.934881  0.809971  0.794255  \ncalib_share_motor_3veh     0.952846  0.825169  0.845748  \ncalib_share_motor_all      0.935159  0.755454  0.813229  \ncalib_share_nonmotor_0veh  0.359545  0.762984  0.852891  \ncalib_share_nonmotor_1veh  0.088131  0.239377  0.232121  \ncalib_share_nonmotor_2veh  0.065119  0.190029  0.205745  \ncalib_share_nonmotor_3veh  0.047154  0.174831  0.154252  \ncalib_share_nonmotor_all   0.064841  0.244546  0.186771  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=24}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n## Non-motorized Trips: Walk vs Bike\n\n::: {#b927e23f .cell execution_count=27}\n``` {.python .cell-code}\n# 2. NON-MOTORIZED TRIPS\nprint(\"\\n\" + \"=\" * 60)\nprint(\"2. NON-MOTORIZED TRIPS\")\nprint(\"=\" * 60)\n\n# non_motorized_mapping = {\n#     'walk' : 'walk',\n#     'bike' : 'bike'\n# }\n\ndf_nonmotorized_cat = calculate_categorical_shares(\n    df_hts_linked,\n    category_col='model_trip_mode_WFv10',\n    weight_col='trip_weight',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='model_trip_mode_WFv10 in [\"walk\", \"bike\"]',\n    category_mapping=None,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_nonmotorized_cat.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_nonmotorized_cat.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_nonmotorized_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n2. NON-MOTORIZED TRIPS\n============================================================\n\nShape: (10, 8)\n\nFirst few rows:\n                            HBO                 HBW                 NHB  \\\n                             OK        PK        OK        PK        OK   \ncalib_share_bike_0veh  0.093370  0.081922  0.126895  0.184947  0.096749   \ncalib_share_bike_1veh  0.141585  0.107295  0.225268  0.300143  0.100676   \ncalib_share_bike_2veh  0.104966  0.139940  0.338888  0.382897  0.076727   \ncalib_share_bike_3veh  0.131393  0.033276  0.110195  0.564415  0.056874   \ncalib_share_bike_all   0.117384  0.107575  0.215958  0.377379  0.076507   \ncalib_share_walk_0veh  0.906630  0.918078  0.873105  0.815053  0.903251   \ncalib_share_walk_1veh  0.858415  0.892705  0.774732  0.699857  0.899324   \ncalib_share_walk_2veh  0.895034  0.860060  0.661112  0.617103  0.923273   \ncalib_share_walk_3veh  0.868607  0.966724  0.889805  0.435585  0.943126   \ncalib_share_walk_all   0.882616  0.892425  0.784042  0.622621  0.923493   \n\n                                    HBSch       HBC  \n                             PK     Daily     Daily  \ncalib_share_bike_0veh  0.168994  0.023156  0.007745  \ncalib_share_bike_1veh  0.110790  0.135214  0.167210  \ncalib_share_bike_2veh  0.074370  0.107164  0.101549  \ncalib_share_bike_3veh  0.076972  0.103986  0.000000  \ncalib_share_bike_all   0.088079  0.107922  0.063449  \ncalib_share_walk_0veh  0.831006  0.976844  0.992255  \ncalib_share_walk_1veh  0.889210  0.864786  0.832790  \ncalib_share_walk_2veh  0.925630  0.892836  0.898451  \ncalib_share_walk_3veh  0.923028  0.896014  1.000000  \ncalib_share_walk_all   0.911921  0.892078  0.936551  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBSch  Daily    1.0\n HBC    Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBSch  Daily    1.0\n HBC    Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBSch  Daily    1.0\n HBC    Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBSch  Daily    1.0\n HBC    Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBSch  Daily    1.0\n HBC    Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n## Motorized Trips: Auto vs Transit\n\n::: {#bff11c73 .cell execution_count=28}\n``` {.python .cell-code}\n# 3. Motorized Trips: Auto vs Transit\nprint(\"\\n\" + \"=\" * 60)\nprint(\"3. MOTORIZED TRIPS: AUTO VS TRANSIT\")\nprint(\"=\" * 60)\n\nmotorized_mapping = {\n    'auto-sov'         : 'auto',\n    'auto-occ2'        : 'auto',\n    'auto-occ3p'       : 'auto',\n    'walk-to-transit'  : 'transit',\n    'drive-to-transit' : 'transit'\n}\n\ndf_motorized_cat = calculate_categorical_shares(\n    df_hts_linked,\n    category_col='model_trip_mode_WFv10',\n    weight_col='trip_weight',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='model_trip_mode_WFv10 in [\"auto-sov\", \"auto-occ2\", \"auto-occ3p\", \"walk-to-transit\", \"drive-to-transit\"]',\n    category_mapping=motorized_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_motorized_cat.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_motorized_cat.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_motorized_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n3. MOTORIZED TRIPS: AUTO VS TRANSIT\n============================================================\n\nShape: (10, 8)\n\nFirst few rows:\n                               HBO                 HBW                 NHB  \\\n                                OK        PK        OK        PK        OK   \ncalib_share_auto_0veh     0.527336  0.729468  0.789658  0.621413  0.748835   \ncalib_share_auto_1veh     0.990194  0.980368  0.954986  0.951697  0.990607   \ncalib_share_auto_2veh     0.996978  0.995458  0.987942  0.985524  0.995562   \ncalib_share_auto_3veh     0.998806  0.998857  0.994109  0.990179  0.993769   \ncalib_share_auto_all      0.992040  0.991716  0.982250  0.981110  0.991993   \ncalib_share_transit_0veh  0.472664  0.270532  0.210342  0.378587  0.251165   \ncalib_share_transit_1veh  0.009806  0.019632  0.045014  0.048303  0.009393   \ncalib_share_transit_2veh  0.003022  0.004542  0.012058  0.014476  0.004438   \ncalib_share_transit_3veh  0.001194  0.001143  0.005891  0.009821  0.006231   \ncalib_share_transit_all   0.007960  0.008284  0.017750  0.018890  0.008007   \n\n                                         HBC     HBSch  \n                                PK     Daily     Daily  \ncalib_share_auto_0veh     0.697496  0.664048  0.383176  \ncalib_share_auto_1veh     0.991856  0.871653  0.978238  \ncalib_share_auto_2veh     0.994075  0.895326  0.989512  \ncalib_share_auto_3veh     0.994297  0.907342  0.997828  \ncalib_share_auto_all      0.992279  0.888739  0.992104  \ncalib_share_transit_0veh  0.302504  0.335952  0.616824  \ncalib_share_transit_1veh  0.008144  0.128347  0.021762  \ncalib_share_transit_2veh  0.005925  0.104674  0.010488  \ncalib_share_transit_3veh  0.005703  0.092658  0.002172  \ncalib_share_transit_all   0.007721  0.111261  0.007896  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=26}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n### Auto Trips: Drive Alone vs Shared Rides\n\n::: {#cd87faa1 .cell execution_count=29}\n``` {.python .cell-code}\n# 4. Auto Trips: Drive Alone vs Shared Rides\nprint(\"\\n\" + \"=\" * 60)\nprint(\"4. AUTO TRIPS: DRIVE ALONE VS SHARED RIDES\")\nprint(\"=\" * 60)\n\nauto_ride_mapping = {\n    'auto-sov'   : 'alone',\n    'auto-occ2'  : 'shared',\n    'auto-occ3p' : 'shared'\n}\n\ndf_auto_riders = calculate_categorical_shares(\n    df_hts_linked,\n    category_col='model_trip_mode_WFv10',\n    weight_col='trip_weight',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='model_trip_mode_WFv10 in [\"auto-sov\", \"auto-occ2\", \"auto-occ3p\"]',\n    category_mapping=auto_ride_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_auto_riders.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_auto_riders.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_auto_riders)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n4. AUTO TRIPS: DRIVE ALONE VS SHARED RIDES\n============================================================\n\nShape: (10, 8)\n\nFirst few rows:\n                              HBO                 HBW                 NHB  \\\n                               OK        PK        OK        PK        OK   \ncalib_share_alone_0veh   0.231886  0.134755  0.251145  0.206815  0.214780   \ncalib_share_alone_1veh   0.450430  0.422546  0.743629  0.767954  0.464611   \ncalib_share_alone_2veh   0.343353  0.306012  0.849545  0.875657  0.393618   \ncalib_share_alone_3veh   0.409285  0.362711  0.866645  0.895452  0.471189   \ncalib_share_alone_all    0.384813  0.343298  0.833347  0.868592  0.434965   \ncalib_share_shared_0veh  0.768114  0.865245  0.748855  0.793185  0.785220   \ncalib_share_shared_1veh  0.549570  0.577454  0.256371  0.232046  0.535389   \ncalib_share_shared_2veh  0.656647  0.693988  0.150455  0.124343  0.606382   \ncalib_share_shared_3veh  0.590715  0.637289  0.133355  0.104548  0.528811   \ncalib_share_shared_all   0.615187  0.656702  0.166653  0.131408  0.565035   \n\n                                        HBC     HBSch  \n                               PK     Daily     Daily  \ncalib_share_alone_0veh   0.361057  0.365629  0.000000  \ncalib_share_alone_1veh   0.516010  0.476547  0.041826  \ncalib_share_alone_2veh   0.411229  0.825620  0.030260  \ncalib_share_alone_3veh   0.471706  0.771353  0.190596  \ncalib_share_alone_all    0.452998  0.718980  0.108671  \ncalib_share_shared_0veh  0.638943  0.634371  1.000000  \ncalib_share_shared_1veh  0.483990  0.523453  0.958174  \ncalib_share_shared_2veh  0.588771  0.174380  0.969740  \ncalib_share_shared_3veh  0.528294  0.228647  0.809404  \ncalib_share_shared_all   0.547002  0.281020  0.891329  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=27}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n#### Shared Rides: 2 People vs 3+ People\n\n::: {#f8c951dc .cell execution_count=30}\n``` {.python .cell-code}\n# 5. Shared Ride by the Number of People\nprint(\"\\n\" + \"=\" * 60)\nprint(\"5. SHARED RIDER BY NUMBER OF PEOPLE\")\nprint(\"=\" * 60)\n\nshared_ride_mapping = {\n    'auto-occ2' : 'sr2',\n    'auto-occ3p': 'sr3'\n}\n\ndf_shared_by_person = calculate_categorical_shares(\n    df_hts_linked,\n    category_col='model_trip_mode_WFv10',\n    weight_col='trip_weight',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='model_trip_mode_WFv10 in [\"auto-occ2\", \"auto-occ3p\"]',\n    category_mapping=shared_ride_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_shared_by_person.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_shared_by_person.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_shared_by_person)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n5. SHARED RIDER BY NUMBER OF PEOPLE\n============================================================\n\nShape: (10, 8)\n\nFirst few rows:\n                           HBO                 HBW                 NHB  \\\n                            OK        PK        OK        PK        OK   \ncalib_share_sr2_0veh  0.709382  0.289280  0.731697  0.857568  0.740220   \ncalib_share_sr2_1veh  0.565882  0.518618  0.726008  0.795799  0.551582   \ncalib_share_sr2_2veh  0.512200  0.461630  0.792496  0.756507  0.458916   \ncalib_share_sr2_3veh  0.574960  0.531453  0.784871  0.702538  0.517496   \ncalib_share_sr2_all   0.543836  0.493188  0.770847  0.747774  0.498240   \ncalib_share_sr3_0veh  0.290618  0.710720  0.268303  0.142432  0.259780   \ncalib_share_sr3_1veh  0.434118  0.481382  0.273992  0.204201  0.448418   \ncalib_share_sr3_2veh  0.487800  0.538370  0.207504  0.243493  0.541084   \ncalib_share_sr3_3veh  0.425040  0.468547  0.215129  0.297462  0.482504   \ncalib_share_sr3_all   0.456164  0.506812  0.229153  0.252226  0.501760   \n\n                                     HBC     HBSch  \n                            PK     Daily     Daily  \ncalib_share_sr2_0veh  0.785824  0.950890  0.000000  \ncalib_share_sr2_1veh  0.509631  0.707841  0.308240  \ncalib_share_sr2_2veh  0.458682  0.968752  0.298725  \ncalib_share_sr2_3veh  0.493538  0.582443  0.437045  \ncalib_share_sr2_all   0.480974  0.733967  0.360179  \ncalib_share_sr3_0veh  0.214176  0.049110  1.000000  \ncalib_share_sr3_1veh  0.490369  0.292159  0.691760  \ncalib_share_sr3_2veh  0.541318  0.031248  0.701275  \ncalib_share_sr3_3veh  0.506462  0.417557  0.562955  \ncalib_share_sr3_all   0.519026  0.266033  0.639821  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n### Transit Trips: By Service and By Access Mode\n\n#### By Service Type\n\n::: {#10958ab2 .cell execution_count=31}\n``` {.python .cell-code}\n# 6. Transit by Service Type (within linked transit trips)\nprint(\"\\n\" + \"=\" * 60)\nprint(\"6. TRANSIT BY SERVICE TYPE\")\nprint(\"=\" * 60)\n\nservice_mapping = {\n    'LCL': 'local',\n    'COR': 'core',\n    'EXP': 'express',\n    'LRT': 'lrt',\n    'CRT': 'crt',\n    'BRT': 'brt'\n}\n\ndf_transit_by_service = calculate_categorical_shares(\n    df_obs_linked,\n    category_col='Linked_Mode_txt',\n    weight_col='LINKED_WEIGHT',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='Linked_Mode_txt != \"MT\"',\n    category_mapping=service_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_transit_by_service.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_transit_by_service.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_transit_by_service)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n6. TRANSIT BY SERVICE TYPE\n============================================================\n\nShape: (25, 8)\n\nFirst few rows:\n                           HBO                 HBW                 NHB  \\\n                            OK        PK        OK        PK        OK   \ncalib_share_brt_0veh  0.093057  0.096456  0.047473  0.095224  0.153395   \ncalib_share_brt_1veh  0.089342  0.054748  0.046183  0.032496  0.148609   \ncalib_share_brt_2veh  0.048919  0.038212  0.028291  0.050144  0.219395   \ncalib_share_brt_3veh  0.069251  0.077194  0.045087  0.046860  0.183415   \ncalib_share_brt_all   0.079479  0.069215  0.042054  0.055455  0.169141   \ncalib_share_crt_0veh  0.050399  0.046084  0.062668  0.066167  0.032120   \ncalib_share_crt_1veh  0.108913  0.108609  0.131166  0.173338  0.079517   \ncalib_share_crt_2veh  0.162660  0.143757  0.185038  0.233631  0.073834   \ncalib_share_crt_3veh  0.188749  0.205590  0.257891  0.309838  0.055098   \ncalib_share_crt_all   0.107888  0.104278  0.144566  0.179742  0.055664   \n\n                                     HBC     HBSch  \n                            PK     Daily     Daily  \ncalib_share_brt_0veh  0.123222  0.270885  0.015133  \ncalib_share_brt_1veh  0.087382  0.280118  0.047447  \ncalib_share_brt_2veh  0.050852  0.191436  0.058813  \ncalib_share_brt_3veh  0.133186  0.237051  0.071987  \ncalib_share_brt_all   0.101817  0.243896  0.052479  \ncalib_share_crt_0veh  0.020874  0.077904  0.000000  \ncalib_share_crt_1veh  0.188967  0.133831  0.014499  \ncalib_share_crt_2veh  0.073795  0.193403  0.078049  \ncalib_share_crt_3veh  0.177490  0.217306  0.131698  \ncalib_share_crt_all   0.095124  0.161091  0.057136  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n#### By Access Mode: Walk vs Drive to Transit\n\n::: {#f444364e .cell execution_count=32}\n``` {.python .cell-code}\n# 7. Transit by Access Type (Walk vs Drive) (within linked transit trips)\nprint(\"\\n\" + \"=\" * 60)\nprint(\"7. TRANSIT BY ACCESS TYPE\")\nprint(\"=\" * 60)\n\naccess_mapping = {\n    'Walk': 'walkacc',\n    'Drive': 'driveacc'\n}\n\ndf_transit_by_access = calculate_categorical_shares(\n    df_obs_linked,\n    category_col='Ac_Mode2_Model',\n    weight_col='LINKED_WEIGHT',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='Linked_Mode_txt != \"MT\"',\n    category_mapping=access_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_transit_by_access.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_transit_by_access.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_transit_by_access)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n7. TRANSIT BY ACCESS TYPE\n============================================================\n\nShape: (10, 8)\n\nFirst few rows:\n                                HBO                 HBW                 NHB  \\\n                                 OK        PK        OK        PK        OK   \ncalib_share_driveacc_0veh  0.042043  0.041143  0.040632  0.044171  0.056313   \ncalib_share_driveacc_1veh  0.121467  0.141475  0.148949  0.206870  0.045113   \ncalib_share_driveacc_2veh  0.173299  0.202267  0.269593  0.365426  0.025015   \ncalib_share_driveacc_3veh  0.256207  0.246329  0.414853  0.422377  0.037477   \ncalib_share_driveacc_all   0.119140  0.129893  0.189060  0.235858  0.044757   \ncalib_share_walkacc_0veh   0.957957  0.958857  0.959368  0.955829  0.943687   \ncalib_share_walkacc_1veh   0.878533  0.858525  0.851051  0.793130  0.954887   \ncalib_share_walkacc_2veh   0.826701  0.797733  0.730407  0.634574  0.974985   \ncalib_share_walkacc_3veh   0.743793  0.753671  0.585147  0.577623  0.962523   \ncalib_share_walkacc_all    0.880860  0.870107  0.810940  0.764142  0.955243   \n\n                                          HBC     HBSch  \n                                 PK     Daily     Daily  \ncalib_share_driveacc_0veh  0.023835  0.034826  0.018714  \ncalib_share_driveacc_1veh  0.081784  0.216398  0.079303  \ncalib_share_driveacc_2veh  0.091050  0.353965  0.161519  \ncalib_share_driveacc_3veh  0.102363  0.524908  0.136143  \ncalib_share_driveacc_all   0.061683  0.300534  0.112939  \ncalib_share_walkacc_0veh   0.976165  0.965174  0.981286  \ncalib_share_walkacc_1veh   0.918216  0.783602  0.920697  \ncalib_share_walkacc_2veh   0.908950  0.646035  0.838481  \ncalib_share_walkacc_3veh   0.897637  0.475092  0.863857  \ncalib_share_walkacc_all    0.938317  0.699466  0.887061  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (2 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=30}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n##### Walk to Transit\n\n::: {#64eae965 .cell execution_count=33}\n``` {.python .cell-code}\n# 8. Walk-to-Transit by Service Type (within walk-to-transit trips)\nprint(\"\\n\" + \"=\" * 60)\nprint(\"8. WALK-TO-TRANSIT BY SERVICE TYPE\")\nprint(\"=\" * 60)\n\nwalk_service_mapping = {\n    'LCL': 'wlocal',\n    'EXP': 'wexpress',\n    'LRT': 'wlrt',\n    'CRT': 'wcrt',\n    'BRT': 'wbrt'\n}\n\ndf_walk_to_transit = calculate_categorical_shares(\n    df_obs_linked,\n    category_col='Linked_Mode_txt',\n    weight_col='LINKED_WEIGHT',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='Ac_Mode2_Model == \"Walk\" & Linked_Mode_txt != \"MT\"',\n    category_mapping=walk_service_mapping,\n    prefix='calib_share'\n)\n\n\nprint(\"\\nShape:\", df_walk_to_transit.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_walk_to_transit.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_walk_to_transit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n8. WALK-TO-TRANSIT BY SERVICE TYPE\n============================================================\n\nShape: (25, 8)\n\nFirst few rows:\n                            HBO                 HBW                 NHB  \\\n                             OK        PK        OK        PK        OK   \ncalib_share_wbrt_0veh  0.097142  0.100595  0.049484  0.099624  0.157465   \ncalib_share_wbrt_1veh  0.101694  0.063769  0.054266  0.039404  0.155630   \ncalib_share_wbrt_2veh  0.059173  0.047900  0.038733  0.060280  0.218994   \ncalib_share_wbrt_3veh  0.089317  0.096841  0.061895  0.081126  0.190556   \ncalib_share_wbrt_all   0.089796  0.079002  0.050130  0.067799  0.173773   \ncalib_share_wcrt_0veh  0.038325  0.033586  0.058874  0.056573  0.017703   \ncalib_share_wcrt_1veh  0.050163  0.047245  0.086122  0.089959  0.064832   \ncalib_share_wcrt_2veh  0.088223  0.059357  0.095408  0.089008  0.056101   \ncalib_share_wcrt_3veh  0.048907  0.077577  0.090973  0.180144  0.024711   \ncalib_share_wcrt_all   0.052514  0.047197  0.079453  0.087829  0.038608   \n\n                                      HBC     HBSch  \n                             PK     Daily     Daily  \ncalib_share_wbrt_0veh  0.126230  0.280659  0.015421  \ncalib_share_wbrt_1veh  0.095165  0.289213  0.025199  \ncalib_share_wbrt_2veh  0.055945  0.205743  0.062380  \ncalib_share_wbrt_3veh  0.148374  0.248898  0.083332  \ncalib_share_wbrt_all   0.108510  0.259711  0.047005  \ncalib_share_wcrt_0veh  0.021384  0.052249  0.000000  \ncalib_share_wcrt_1veh  0.149215  0.053229  0.002169  \ncalib_share_wcrt_2veh  0.051479  0.075014  0.019002  \ncalib_share_wcrt_3veh  0.123171  0.094045  0.009820  \ncalib_share_wcrt_all   0.072236  0.065616  0.009058  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=31}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n        PK       1.0\n HBC    Daily    1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n##### Drive to Transit\n\n::: {#41f4bf3e .cell execution_count=34}\n``` {.python .cell-code}\n# 9. Drive-to-Transit by Service Type (within drive-to-transit trips)\nprint(\"\\n\" + \"=\" * 60)\nprint(\"9. DRIVE-TO-TRANSIT BY SERVICE TYPE\")\nprint(\"=\" * 60)\n\ndrive_service_mapping = {\n    'LCL': 'dlocal',\n    'EXP': 'dexpress',\n    'LRT': 'dlrt',\n    'CRT': 'dcrt',\n    'BRT': 'dbrt'\n}\n\ndf_drive_to_transit = calculate_categorical_shares(\n    df_obs_linked,\n    category_col='Linked_Mode_txt',\n    weight_col='LINKED_WEIGHT',\n    group_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    filter_condition='Ac_Mode2_Model == \"Drive\" & Linked_Mode_txt != \"MT\"',\n    category_mapping=drive_service_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nShape:\", df_drive_to_transit.shape)\nprint(\"\\nFirst few rows:\")\nprint(df_drive_to_transit.head(10))\nprint(\"\\nVerification:\")\nverify_shares(df_drive_to_transit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================\n9. DRIVE-TO-TRANSIT BY SERVICE TYPE\n============================================================\n\nShape: (24, 8)\n\nFirst few rows:\n                            HBO                 HBW                 NHB  \\\n                             OK        PK        OK        PK        OK   \ncalib_share_dbrt_0veh  0.000000  0.000000  0.000000  0.000000  0.085185   \ncalib_share_dbrt_1veh  0.000000  0.000000  0.000000  0.006011  0.000000   \ncalib_share_dbrt_2veh  0.000000  0.000000  0.000000  0.032543  0.235044   \ncalib_share_dbrt_3veh  0.010999  0.017082  0.021379  0.000000  0.000000   \ncalib_share_dbrt_all   0.003201  0.003659  0.007410  0.015461  0.070286   \ncalib_share_dcrt_0veh  0.325511  0.337345  0.152258  0.273792  0.273724   \ncalib_share_dcrt_1veh  0.533837  0.480993  0.388536  0.493010  0.390337   \ncalib_share_dcrt_2veh  0.517750  0.476627  0.427870  0.484774  0.764956   \ncalib_share_dcrt_3veh  0.594724  0.597261  0.493327  0.487201  0.835507   \ncalib_share_dcrt_all   0.517299  0.486644  0.423858  0.477524  0.419687   \n\n                            HBC       NHB     HBSch  \n                          Daily        PK     Daily  \ncalib_share_dbrt_0veh  0.000000  0.000000  0.000000  \ncalib_share_dbrt_1veh  0.247186  0.000000  0.305749  \ncalib_share_dbrt_2veh  0.165324  0.000000  0.040294  \ncalib_share_dbrt_3veh  0.226328  0.000000  0.000000  \ncalib_share_dbrt_all   0.207087  0.000000  0.095469  \ncalib_share_dcrt_0veh  0.788925  0.000000  0.000000  \ncalib_share_dcrt_1veh  0.425698  0.635278  0.157648  \ncalib_share_dcrt_2veh  0.409480  0.296569  0.384571  \ncalib_share_dcrt_3veh  0.328868  0.653824  0.905038  \ncalib_share_dcrt_all   0.383302  0.443292  0.434748  \n\nVerification:\n=== Verifying Share Sums ===\n\nVehicle categories found: ['0veh', '1veh', '2veh', '3veh', 'all']\n\n--- Checking 0veh (4 categories) ---\n  ‚úÖ All shares sum to 1.0 for 0veh\n\n--- Checking 1veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 1veh\n\n--- Checking 2veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 2veh\n\n--- Checking 3veh (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for 3veh\n\n--- Checking all (5 categories) ---\n  ‚úÖ All shares sum to 1.0 for all\n\n============================================================\n‚úÖ ALL VEHICLE CATEGORIES: Shares sum to 1.0 (within tolerance)\n\nTotal columns: 8\nTotal vehicle categories: 5\nTotal combinations: 40\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\n{'0veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n HBC    Daily    1.0\n NHB    PK       1.0\n HBSch  Daily    1.0\n dtype: float64,\n '1veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n HBC    Daily    1.0\n NHB    PK       1.0\n HBSch  Daily    1.0\n dtype: float64,\n '2veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n HBC    Daily    1.0\n NHB    PK       1.0\n HBSch  Daily    1.0\n dtype: float64,\n '3veh': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n HBC    Daily    1.0\n NHB    PK       1.0\n HBSch  Daily    1.0\n dtype: float64,\n 'all': HBO    OK       1.0\n        PK       1.0\n HBW    OK       1.0\n        PK       1.0\n NHB    OK       1.0\n HBC    Daily    1.0\n NHB    PK       1.0\n HBSch  Daily    1.0\n dtype: float64}\n```\n:::\n:::\n\n\n# Export Calibration Target Files\n\n::: {#41de17f6 .cell execution_count=35}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\n\ndef create_tree_dataframe(\n    df_alltrips_cat,\n    df_nonmotorized_cat,\n    df_motorized_cat,\n    df_auto_riders,\n    df_shared_by_person,\n    df_transit_by_access,\n    df_walk_to_transit,\n    df_drive_to_transit,\n    purpose='HBW',\n    veh_cat='all',\n    period=None\n):\n    \"\"\"\n    Create a hierarchical dataframe using path format.\n    Each row represents one node with its full path from root.\n    Returns dataframe with level1, level2, level3, level4, and value columns.\n\n    Parameters:\n    -----------\n    purpose : str\n        Trip purpose (e.g., 'HBW', 'HBO', 'NHB', 'HBC', 'HBSch')\n    veh_cat : str\n        Vehicle category ('all', '0veh', '1veh', '2veh', '3veh')\n    period : str or None\n        Time period ('PK', 'OK', 'Daily', or None to average PK+OK)\n    \"\"\"\n\n    def get_value(df, var_name, purpose, veh_cat='all', period=None):\n        \"\"\"Get value for specific purpose, vehicle category, and period\"\"\"\n        var_full = f\"calib_share_{var_name}_{veh_cat}\"\n\n        if var_full not in df.index:\n            return 0.0\n\n        # If specific period is requested\n        if period:\n            if (purpose, period) in df.columns:\n                val = df.loc[var_full, (purpose, period)]\n                return val if pd.notna(val) else 0.0\n            else:\n                return 0.0\n\n        # Otherwise average PK and OK\n        total = 0.0\n        count = 0\n\n        for per in ['PK', 'OK']:\n            if (purpose, per) in df.columns:\n                val = df.loc[var_full, (purpose, per)]\n                if pd.notna(val):\n                    total += val\n                    count += 1\n\n        # If no PK/OK, try Daily\n        if count == 0 and (purpose, 'Daily') in df.columns:\n            val = df.loc[var_full, (purpose, 'Daily')]\n            if pd.notna(val):\n                return val\n\n        return total / count if count > 0 else 0.0\n\n    # Get all conditional shares\n    nonmotor_share = get_value(df_alltrips_cat, 'nonmotor', purpose, veh_cat, period)\n    motor_share = 1.0 - nonmotor_share\n\n    walk_share = get_value(df_nonmotorized_cat, 'walk', purpose, veh_cat, period)\n    bike_share = get_value(df_nonmotorized_cat, 'bike', purpose, veh_cat, period)\n\n    auto_share = get_value(df_motorized_cat, 'auto', purpose, veh_cat, period)\n    transit_share = get_value(df_motorized_cat, 'transit', purpose, veh_cat, period)\n\n    alone_share = get_value(df_auto_riders, 'alone', purpose, veh_cat, period)\n    shared_share = get_value(df_auto_riders, 'shared', purpose, veh_cat, period)\n\n    sr2_share = get_value(df_shared_by_person, 'sr2', purpose, veh_cat, period)\n    sr3_share = get_value(df_shared_by_person, 'sr3', purpose, veh_cat, period)\n\n    walkacc_share = get_value(df_transit_by_access, 'walkacc', purpose, veh_cat, period)\n    driveacc_share = get_value(df_transit_by_access, 'driveacc', purpose, veh_cat, period)\n\n    # Get walk-to-transit service type shares\n    wlocal_share = get_value(df_walk_to_transit, 'wlocal', purpose, veh_cat, period)\n    wcore_share = get_value(df_walk_to_transit, 'wcore', purpose, veh_cat, period)\n    wexpress_share = get_value(df_walk_to_transit, 'wexpress', purpose, veh_cat, period)\n    wlrt_share = get_value(df_walk_to_transit, 'wlrt', purpose, veh_cat, period)\n    wcrt_share = get_value(df_walk_to_transit, 'wcrt', purpose, veh_cat, period)\n    wbrt_share = get_value(df_walk_to_transit, 'wbrt', purpose, veh_cat, period)\n\n    # Get drive-to-transit service type shares\n    dlocal_share = get_value(df_drive_to_transit, 'dlocal', purpose, veh_cat, period)\n    dcore_share = get_value(df_drive_to_transit, 'dcore', purpose, veh_cat, period)\n    dexpress_share = get_value(df_drive_to_transit, 'dexpress', purpose, veh_cat, period)\n    dlrt_share = get_value(df_drive_to_transit, 'dlrt', purpose, veh_cat, period)\n    dcrt_share = get_value(df_drive_to_transit, 'dcrt', purpose, veh_cat, period)\n    dbrt_share = get_value(df_drive_to_transit, 'dbrt', purpose, veh_cat, period)\n\n    # Base value\n    total_value = 1.0\n\n    # Create rows in path format\n    rows = []\n\n    # Determine display period\n    display_period = period if period else 'Daily'\n\n    # Non-motorized branch\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Non-motorized',\n        'level2': 'Walk',\n        'level3': None,\n        'level4': None,\n        'value': total_value * nonmotor_share * walk_share * 100\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Non-motorized',\n        'level2': 'Bike',\n        'level3': None,\n        'level4': None,\n        'value': total_value * nonmotor_share * bike_share * 100\n    })\n\n    # Motorized > Auto > Drive Alone\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Auto',\n        'level3': 'Drive Alone',\n        'level4': None,\n        'value': total_value * motor_share * auto_share * alone_share * 100\n    })\n\n    # Motorized > Auto > Shared Ride > SR2\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Auto',\n        'level3': 'Shared Ride',\n        'level4': 'SR2 (2 people)',\n        'value': total_value * motor_share * auto_share * shared_share * sr2_share * 100\n    })\n\n    # Motorized > Auto > Shared Ride > SR3\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Auto',\n        'level3': 'Shared Ride',\n        'level4': 'SR3 (3+ people)',\n        'value': total_value * motor_share * auto_share * shared_share * sr3_share * 100\n    })\n\n    # Motorized > Transit > Walk-to-Transit > Service Types\n    walk_transit_base = total_value * motor_share * transit_share * walkacc_share * 100\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Walk-to-Transit',\n        'level4': 'Local Bus',\n        'value': walk_transit_base * wlocal_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Walk-to-Transit',\n        'level4': 'Core Bus',\n        'value': walk_transit_base * wcore_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Walk-to-Transit',\n        'level4': 'Express Bus',\n        'value': walk_transit_base * wexpress_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Walk-to-Transit',\n        'level4': 'LRT',\n        'value': walk_transit_base * wlrt_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Walk-to-Transit',\n        'level4': 'CRT',\n        'value': walk_transit_base * wcrt_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Walk-to-Transit',\n        'level4': 'BRT',\n        'value': walk_transit_base * wbrt_share\n    })\n\n    # Motorized > Transit > Drive-to-Transit > Service Types\n    drive_transit_base = total_value * motor_share * transit_share * driveacc_share * 100\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Drive-to-Transit',\n        'level4': 'Local Bus',\n        'value': drive_transit_base * dlocal_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Drive-to-Transit',\n        'level4': 'Core Bus',\n        'value': drive_transit_base * dcore_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Drive-to-Transit',\n        'level4': 'Express Bus',\n        'value': drive_transit_base * dexpress_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Drive-to-Transit',\n        'level4': 'LRT',\n        'value': drive_transit_base * dlrt_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Drive-to-Transit',\n        'level4': 'CRT',\n        'value': drive_transit_base * dcrt_share\n    })\n\n    rows.append({\n        'purpose': purpose,\n        'period': display_period,\n        'veh_cat': veh_cat,\n        'level1': 'Motorized',\n        'level2': 'Transit',\n        'level3': 'Drive-to-Transit',\n        'level4': 'BRT',\n        'value': drive_transit_base * dbrt_share\n    })\n\n    df_tree = pd.DataFrame(rows)\n    return df_tree\n\n\n# Create comprehensive dataframe with all combinations\n\n# Define all categories\npurposes = ['HBW', 'HBO', 'NHB', 'HBC', 'HBSch']\nperiods = ['PK', 'OK', 'Daily']\nveh_cats = ['all', '0veh', '1veh', '2veh', '3veh']\n\n# Create list to store all dataframes\nall_dfs = []\n\n# Loop through all combinations\nfor purpose in purposes:\n    for period in periods:\n        # Skip Daily for purposes that have PK/OK breakdown\n        if purpose in ['HBW', 'HBO', 'NHB'] and period == 'Daily':\n            continue\n\n        # Skip PK/OK for purposes that only have Daily\n        if purpose in ['HBC', 'HBSch'] and period in ['PK', 'OK']:\n            continue\n\n        for veh_cat in veh_cats:\n            df_temp = create_tree_dataframe(\n                df_alltrips_cat,\n                df_nonmotorized_cat,\n                df_motorized_cat,\n                df_auto_riders,\n                df_shared_by_person,\n                df_transit_by_access,\n                df_walk_to_transit,\n                df_drive_to_transit,\n                purpose=purpose,\n                veh_cat=veh_cat,\n                period=period\n            )\n            all_dfs.append(df_temp)\n\n# Combine all dataframes\ndf_tree_all = pd.concat(all_dfs, ignore_index=True)\n\ndf_tree_all.head(20)\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>purpose</th>\n      <th>period</th>\n      <th>veh_cat</th>\n      <th>level1</th>\n      <th>level2</th>\n      <th>level3</th>\n      <th>level4</th>\n      <th>value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Non-motorized</td>\n      <td>Walk</td>\n      <td>None</td>\n      <td>None</td>\n      <td>1.526723</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Non-motorized</td>\n      <td>Bike</td>\n      <td>None</td>\n      <td>None</td>\n      <td>0.925368</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Auto</td>\n      <td>Drive Alone</td>\n      <td>None</td>\n      <td>83.128756</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Auto</td>\n      <td>Shared Ride</td>\n      <td>SR2 (2 people)</td>\n      <td>9.404322</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Auto</td>\n      <td>Shared Ride</td>\n      <td>SR3 (3+ people)</td>\n      <td>3.172105</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Walk-to-Transit</td>\n      <td>Local Bus</td>\n      <td>0.618767</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Walk-to-Transit</td>\n      <td>Core Bus</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Walk-to-Transit</td>\n      <td>Express Bus</td>\n      <td>0.019032</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Walk-to-Transit</td>\n      <td>LRT</td>\n      <td>0.551166</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Walk-to-Transit</td>\n      <td>CRT</td>\n      <td>0.123672</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Walk-to-Transit</td>\n      <td>BRT</td>\n      <td>0.095468</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Drive-to-Transit</td>\n      <td>Local Bus</td>\n      <td>0.038736</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Drive-to-Transit</td>\n      <td>Core Bus</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Drive-to-Transit</td>\n      <td>Express Bus</td>\n      <td>0.020564</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Drive-to-Transit</td>\n      <td>LRT</td>\n      <td>0.161060</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Drive-to-Transit</td>\n      <td>CRT</td>\n      <td>0.207543</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>all</td>\n      <td>Motorized</td>\n      <td>Transit</td>\n      <td>Drive-to-Transit</td>\n      <td>BRT</td>\n      <td>0.006720</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>0veh</td>\n      <td>Non-motorized</td>\n      <td>Walk</td>\n      <td>None</td>\n      <td>None</td>\n      <td>29.838315</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>0veh</td>\n      <td>Non-motorized</td>\n      <td>Bike</td>\n      <td>None</td>\n      <td>None</td>\n      <td>6.770722</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>HBW</td>\n      <td>PK</td>\n      <td>0veh</td>\n      <td>Motorized</td>\n      <td>Auto</td>\n      <td>Drive Alone</td>\n      <td>None</td>\n      <td>8.146825</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n::: {#8e1eca81 .cell execution_count=37}\n``` {.python .cell-code}\n# Create interactive treemap with properly coordinated dropdowns\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nimport pandas as pd\n\n# Get unique values for dropdowns\npurposes = sorted(df_tree_all['purpose'].unique())\nperiods = sorted(df_tree_all['period'].unique())\nveh_cats = sorted(df_tree_all['veh_cat'].unique())\n\n# Create all trace combinations and store them\ntraces = []\ntrace_lookup = {}  # Map (purpose, period, veh_cat) to trace index\n\nfor purpose in purposes:\n    for period in periods:\n        for veh_cat in veh_cats:\n            df_filtered = df_tree_all.query(\n                f\"purpose == '{purpose}' & veh_cat == '{veh_cat}' & period == '{period}'\"\n            ).copy()\n\n            if len(df_filtered) > 0:\n                # Create treemap trace\n                labels = []\n                parents = []\n                values = []\n\n                # Root\n                labels.append(\"All Trips\")\n                parents.append(\"\")\n                values.append(100)\n\n                # Add all hierarchy levels\n                for _, row in df_filtered.iterrows():\n                    # Level 1\n                    if row['level1'] not in labels:\n                        labels.append(row['level1'])\n                        parents.append(\"All Trips\")\n                        values.append(df_filtered[df_filtered['level1'] == row['level1']]['value'].sum())\n\n                    # Level 2\n                    if pd.notna(row['level2']):\n                        level2_id = row['level2']\n                        if level2_id not in labels:\n                            labels.append(level2_id)\n                            parents.append(row['level1'])\n                            values.append(df_filtered[\n                                (df_filtered['level1'] == row['level1']) &\n                                (df_filtered['level2'] == row['level2'])\n                            ]['value'].sum())\n\n                        # Level 3\n                        if pd.notna(row['level3']):\n                            level3_id = row['level3']\n                            if level3_id not in labels:\n                                labels.append(level3_id)\n                                parents.append(level2_id)\n                                values.append(df_filtered[\n                                    (df_filtered['level1'] == row['level1']) &\n                                    (df_filtered['level2'] == row['level2']) &\n                                    (df_filtered['level3'] == row['level3'])\n                                ]['value'].sum())\n\n                            # Level 4\n                            if pd.notna(row['level4']):\n                                level4_id = row['level4']\n                                labels.append(level4_id)\n                                parents.append(level3_id)\n                                values.append(row['value'])\n\n                trace = go.Treemap(\n                    labels=labels,\n                    parents=parents,\n                    values=values,\n                    branchvalues=\"total\",\n                    visible=False,\n                    name=f\"{purpose}_{period}_{veh_cat}\",\n                    textposition=\"middle center\"\n                )\n\n                trace_lookup[(purpose, period, veh_cat)] = len(traces)\n                traces.append(trace)\n\n# Set initial trace visible\ninitial_purpose = 'HBW'\ninitial_period = 'PK'\ninitial_veh = 'all'\n\nif (initial_purpose, initial_period, initial_veh) in trace_lookup:\n    traces[trace_lookup[(initial_purpose, initial_period, initial_veh)]].visible = True\n\n# Create figure\nfig = go.Figure(data=traces)\n\n# Create combined dropdown options (all combinations)\ndropdown_options = []\n\nfor purpose in purposes:\n    for period in periods:\n        # Check if this purpose-period combination exists\n        has_data = False\n        for veh_cat in veh_cats:\n            if (purpose, period, veh_cat) in trace_lookup:\n                has_data = True\n                break\n\n        if not has_data:\n            continue\n\n        for veh_cat in veh_cats:\n            if (purpose, period, veh_cat) in trace_lookup:\n                visible = [False] * len(traces)\n                idx = trace_lookup[(purpose, period, veh_cat)]\n                visible[idx] = True\n\n                dropdown_options.append(\n                    dict(\n                        label=f\"{purpose} | {period} | {veh_cat}\",\n                        method=\"update\",\n                        args=[\n                            {\"visible\": visible},\n                            {\"title\": f\"Mode Choice Hierarchy: {purpose} - {period} - {veh_cat}\"}\n                        ]\n                    )\n                )\n\n# Update layout with single combined dropdown\nfig.update_layout(\n    updatemenus=[\n        dict(\n            buttons=dropdown_options,\n            direction=\"down\",\n            showactive=True,\n            x=0.5,\n            xanchor=\"center\",\n            y=1.15,\n            yanchor=\"top\",\n            bgcolor=\"white\",\n            bordercolor=\"gray\",\n            borderwidth=1\n        )\n    ],\n    title=f\"Mode Choice Hierarchy: {initial_purpose} - {initial_period} - {initial_veh}\",\n    margin=dict(t=120, l=25, r=25, b=25),\n    height=800\n)\n\nfig.update_traces(root_color=\"lightgrey\")\n\nfig.show()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.2.0.min.js\" integrity=\"sha256-iZ2u/oU2wf/vDbl/ChcX93WgbBRSBvUO6N413hDz7xM=\" crossorigin=\"anonymous\"></script>                <div id=\"0f416688-86aa-4257-b7be-e7188cf5aa98\" class=\"plotly-graph-div\" style=\"height:800px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"0f416688-86aa-4257-b7be-e7188cf5aa98\")) {                    Plotly.newPlot(                        \"0f416688-86aa-4257-b7be-e7188cf5aa98\",                        [{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBC_Daily_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,76.29835654208583,75.70739160961296,0.5909649324728787,23.70164345791415,15.739018291740473,5.754635960460987,9.984382331279487,9.494045160484403,0.49033717079508526,7.962625166173681,7.6853169547986075,3.6091536059922595,0.0,0.035835730924562915,1.4818269033875546,0.4015466320288432,2.1569540824653872,0.27730821137507305,0.0008425706352837411,0.0,0.0,0.057690175373119566,0.21877546536666972,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBC_Daily_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,23.93773717358632,19.93511294222713,4.002624231359192,76.0622628264137,66.29993334977901,31.595006322795076,34.70492702698394,24.565567161349207,10.13935986563473,9.762329476634676,7.649778583042678,3.0488001822854707,0.0,0.0335545707230727,1.9478223303829294,0.40718854148026373,2.2124129581709404,2.1125508935919983,0.28552759280641404,0.0,0.0,0.4055199850259181,0.8993097155827452,0.5221936001769207],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBC_Daily_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,19.002942020491002,17.073211590403194,1.9297304300878073,80.99705797950902,72.51880880640549,59.8730074102247,12.645801396180792,12.25064643890301,0.3951549572777828,8.478249173103528,5.477244334356931,2.4757627892126384,0.0,0.11928935343148672,1.3444202008962078,0.4108674392910625,1.1269045515255358,3.0010048387465957,0.502485405716991,0.0,0.03952501362200396,0.7340030635398973,1.2288524681975976,0.4961388876701056],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBC_Daily_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,17.483098341109535,17.483098341109535,0.0,82.51690165889046,74.87107135537417,57.75199345100559,17.11907790436857,9.970889058653805,7.148188845714765,7.645830303516298,3.632474752588553,1.6741757099064987,0.0,0.0263873590089087,0.6861782827672858,0.34161759464013525,0.9041158062657243,4.013355550927747,0.8330617465492887,0.0,0.03140570087631279,0.9206893386592448,1.3198638461948147,0.9083349186480854],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBC_Daily_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,24.4545629119682,22.90295622604272,1.551606685925481,75.54543708803178,67.14016490782281,48.27242273563398,18.867742172188823,13.848304154188524,5.019438018000299,8.405272180208982,5.87920475732263,2.5936895443931784,0.0,0.05370723262378295,1.3191442342181199,0.38576844446578057,1.5268953016217683,2.526067422886353,0.4447065907771738,0.0,0.01939517553486632,0.5706042080154548,0.9682459647102956,0.5231154838485623],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_OK_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,38.711211782485286,35.096757426358174,3.6144543561271147,61.28878821751471,32.31980521586192,7.494495152168161,24.825310063693763,17.61062859050355,7.214681473190213,28.968983001652784,27.751040287424754,12.836824536716728,0.0,0.012486847276247041,11.142388783545664,1.0635610001399494,2.6957791197461662,1.2179427142280326,0.29279842195022654,0.0,0.0,0.5286908633441755,0.39645342893363056,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_OK_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,8.487245930753327,7.285575588122725,1.201670342630602,91.51275406924667,90.615342997083,40.81591168906616,49.79943130801685,28.180591341244902,21.618839966771944,0.8974110721636651,0.7884051292014086,0.33933544333499577,0.0,0.001173421218383717,0.3281716797221093,0.039548458639596676,0.08017612628632306,0.10900594296225648,0.018533781413058708,0.0,0.0,0.03228074375288845,0.05819141779630932,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_OK_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,7.111318871734493,6.364875327695548,0.7464435440389459,92.88868112826547,92.6079372708967,31.797226099177834,60.810711171718864,31.147230259232376,29.663480912486488,0.28074385736879565,0.23209110252255125,0.0966782435183364,0.0,0.000721910842964107,0.10048159595814783,0.020475781177467012,0.013733571025635905,0.04865275484624441,0.002346380619719558,0.0,0.0,0.0211163975589319,0.02518997666759295,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_OK_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,3.985831241831182,3.462121756539226,0.5237094852919558,96.01416875816882,95.89950723590384,39.250229087862905,56.64927814804092,32.571058763779895,24.07821938426103,0.1146615222649882,0.08528438582200432,0.037504791567521845,0.0,0.0,0.03599128142706091,0.004170992632810171,0.007617320194611394,0.029377136442983884,0.0024718748542277634,0.0,0.0,0.009110875161110723,0.017471277374691965,0.0003231090529534328],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_OK_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,6.667475986421615,5.884818108031126,0.7826578783904884,93.33252401357835,92.58955813810483,35.629686976917725,56.95987116118711,30.976802801049374,25.983068360137736,0.7429658754735328,0.6544490588704898,0.2896771805964028,0.0,0.0007810597396606439,0.27085624393118685,0.034367698125735736,0.0587668764775038,0.08851681660304304,0.010367597538659892,0.0,0.0,0.032076263831669664,0.04578962316160272,0.0002833320711107669],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_PK_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,25.993945746566148,23.864472413371658,2.1294733331944897,74.00605425343385,53.985038720869156,7.274727384318898,46.710311336550255,13.512365834675661,33.19794550187459,20.021015532564707,19.197296654029387,7.934456489332123,0.0,0.06380801860515081,8.623113821757537,0.6447654734606283,1.9311528508739506,0.8237188785353178,0.03482405854528932,0.0,0.0,0.5110174346231581,0.2778773853668703,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_PK_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,9.239933126275405,8.248530964373883,0.9914021619015218,90.76006687372461,88.97829584754932,37.59739949325594,51.38089635429337,26.64703853594139,24.733857818351982,1.781771026175287,1.529695669513532,0.4314107037175351,0.0,0.0,0.9284671358277317,0.0722700299080146,0.09754780006025071,0.2520753566617552,0.017116276566450397,0.0,0.0,0.11371259624663649,0.12124648384866826,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_PK_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,7.4447958664591285,6.402971255713302,1.0418246107458267,92.55520413354085,92.1347745176241,28.1943787564131,63.94039576121099,29.516830861302406,34.42356489990859,0.42042961591675415,0.33539060326563164,0.1622761218802744,0.0,0.0005064024858031519,0.13663497789828657,0.019907815834386715,0.016065285166880793,0.08503901265112249,0.006400404925227211,0.0,0.0007555977973958531,0.037351086236436105,0.04053192369206333,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_PK_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,3.7184369330364864,3.594703953258212,0.12373297977827427,96.2815630669635,96.17154262615647,34.882475301883616,61.28906732427285,32.572279598369875,28.716787725902975,0.11002044080702875,0.0829192698373173,0.03578316903588029,0.0,0.0014488686211501986,0.03122458054125266,0.006432644035369124,0.008030007603665032,0.027101170969711447,0.000661757803891467,0.0,0.0,0.009789987258116441,0.01618647547518686,0.00046295043251667846],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBO_PK_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,6.579680272173474,5.871871690223567,0.7078085819499066,93.42031972782648,92.64638892395243,31.805306054738438,60.84108286921399,30.006069305120036,30.83501356409396,0.7739308038740543,0.6734024509163566,0.2686342920790028,0.0,0.002336629621436114,0.3174490889526306,0.03178243385121283,0.05320000641207437,0.10052835295769756,0.005864439372500888,0.0,0.0003493338702902791,0.04502515548949032,0.04892156741580218,0.0003678568096138851],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBSch_Daily_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,85.28905448148566,83.31408242980828,1.9749720516773834,14.71094551851435,5.636876845273448,0.0,5.636876845273448,0.0,5.636876845273448,9.074068673240903,8.904258376740074,7.13438822702664,0.0,0.0,1.6325543904502313,0.0,0.13731575926320333,0.16981029650082918,0.0,0.0,0.0,0.16981029650082918,0.0,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBSch_Daily_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,23.21206989306636,20.07347850378979,3.138591389276569,76.78793010693366,75.11688661308277,3.141829857087828,71.97505675599494,22.18559868740121,49.78945806859373,1.6710434938508831,1.5385248800915292,1.1668604671889804,0.0,0.0,0.32955735180366164,0.0033377223441302226,0.03876933875475699,0.1325186137593538,0.015929282303603135,0.0,0.0,0.055180643257470685,0.020891292384701513,0.04051739581357847],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBSch_Daily_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,20.57451285718215,18.369656389278617,2.204856467903532,79.42548714281787,78.59249119765228,2.3781866965114573,76.21430450114082,22.767118573626682,53.44718592751414,0.832995945165575,0.6984513575083143,0.499783797310336,0.0,0.006067985380871938,0.13575765539944917,0.013272218512729705,0.04356970090492753,0.13454458765726057,0.029912921925735487,0.0,0.0,0.04746838949580268,0.05174199197019872,0.0054212842655236735],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBSch_Daily_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,15.425184381361136,13.821188297091583,1.603996084269554,84.57481561863885,84.39114684398687,16.084574534656486,68.30657230933039,29.853023653764353,38.45354865556604,0.18366877465197023,0.15866352340599008,0.12020004498982516,0.0,0.00100642888418481,0.022677308008617635,0.0015580515538112286,0.013221689969551248,0.025005251245980152,0.0023745583895435365,0.0,0.0,0.0,0.022630692856436617,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBSch_Daily_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,18.677142991656424,16.661459388136812,2.015683603519611,81.32285700834359,80.68070137382213,8.767677449946095,71.91302392387604,25.901580281121223,46.01144364275482,0.6421556345214459,0.5696309787356387,0.4264379871044959,0.0,0.002339970199235311,0.10891744076091374,0.0051599474517245005,0.026775633219269273,0.07252465578580719,0.012037362139753508,0.0,0.0,0.02203344926064747,0.03152995573326499,0.006923888652141213],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_OK_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,36.28832631403553,31.68351482610398,4.604811487931546,63.71167368596448,50.31045284258507,12.635226020578394,37.67522682200668,27.5668620857771,10.108364736229582,13.401220843379408,12.856707395609462,6.187117163315783,0.0,0.016323497158845915,5.260140382531435,0.7569266779731147,0.6361996746302858,0.5445134477699451,0.02649233971576156,0.0,0.0,0.43511432164291874,0.08290678641126482,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_OK_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,3.858275277475774,2.9891275900395735,0.8691476874362001,96.14172472252426,91.81397848192489,68.27554783071035,23.538430651214544,17.08909178941508,6.449338861799466,4.3277462405993505,3.6831312549769066,1.6050631894235134,0.0,0.02494443171236578,1.536054996259152,0.31719875744903425,0.1998698801328407,0.6446149856224446,0.029376512575420066,0.0,0.013976827111843629,0.3508055104061075,0.2504561355290734,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_OK_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,3.5439444897632155,2.3429442630474155,1.2010002267158002,96.45605551023678,95.29301009737821,80.95568442428717,14.337325673091044,11.362270278692634,2.9750553943984097,1.1630454128585677,0.8494960981290375,0.32429655340208136,0.0,0.001242216420093772,0.41000497318631307,0.08104868157062331,0.032903673549926044,0.31354931472953007,0.012244289093086566,0.0,0.012793510227416321,0.15435310205219335,0.13415841335683384,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_OK_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,1.7484116848924893,1.555744756025264,0.19266692886722528,98.25158831510751,97.67283423046382,84.64766988690184,13.025164343561988,10.22307763617275,2.802086707389238,0.5787540846436855,0.338656280553321,0.16506587390633312,0.0,0.0028003183093509355,0.11902039764863691,0.030808466281827974,0.02096122440717199,0.2400978040903645,0.037763107245933424,0.0,0.00506478528883428,0.0736900472652307,0.11844673457245478,0.005133129717911315],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_OK_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,3.6784838556908284,2.884084216451813,0.7943996392390154,96.32151614430917,94.61177207454655,78.84439221627503,15.767379858271525,12.154230979181591,3.6131488790899335,1.709744069762617,1.3864992856009413,0.6174392320038989,0.0,0.005434734266757337,0.5839575550563403,0.11016186270483375,0.06950590156911118,0.3232447841616756,0.026581298411832995,0.0,0.008641886264836939,0.14861656987188093,0.1370097265432649,0.002395303069859876],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_PK_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,36.60903762038597,29.838315480507845,6.770722139878122,63.390962379614024,39.391941974102224,8.146825157812374,31.245116816289848,26.79482368116533,4.450293135124517,23.999020405511796,22.938962947200054,10.29967304209979,0.0,0.24838246175638531,8.807913283349652,1.2977184404069138,2.2852757195873092,1.0600574583117444,0.15722347459036182,0.0,0.0,0.6125988886042816,0.29023509511710105,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_PK_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,4.659239627038356,3.2608001685472834,1.3984394584910722,95.34076037296165,90.73550982786998,69.68069191170673,21.05481791616324,16.75540377035635,4.299414145806893,4.605250545091663,3.652563659647229,1.5333694819303418,0.0,0.0672012327453635,1.5794842595961494,0.3285825184651055,0.14392616691026916,0.9526868854444339,0.0988008033271343,0.0,0.023431888732799284,0.3550438857547066,0.4696839716906254,0.005726335939168371],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_PK_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,2.3187033838207167,1.4308797682644285,0.887823615556288,97.68129661617927,96.2672423543299,84.29704514499939,11.970197209330516,9.055543406813218,2.9146538025172983,1.4140542618493783,0.8973218431252947,0.4001876732551825,0.0,0.007994505037152622,0.3551801795586149,0.07986925312460558,0.054090232149739036,0.5167324187240837,0.040071226997673605,0.0,0.02850214173783599,0.18084459412365372,0.25049828265799656,0.01681617320692385],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_PK_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,1.2470150632087624,0.5431815985930716,0.703833464615691,98.75298493679121,97.7831395977294,87.56006930634574,10.223070291383664,7.182092207641788,3.040978083741875,0.9698453390618101,0.5602045104006406,0.25919911350997754,0.0,0.008692585498585271,0.145948044206655,0.10091749789932337,0.04544726928609941,0.4096408286611696,0.032429301653164,0.0,0.02941006914717751,0.1482239838353777,0.19957747402545034,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"HBW_PK_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,2.4520907081813896,1.5267228498396976,0.925367858341692,97.54790929181866,95.70518230914037,83.12875560883448,12.576426700305886,9.404321710141803,3.1721049901640828,1.8427269826782684,1.4081047885948308,0.6187667214372671,0.0,0.019032292238869427,0.5511655787990679,0.12367205515634053,0.0954681409632859,0.4346221940834375,0.038735803314380785,0.0,0.020564482538739146,0.16105974413440302,0.20754266346762368,0.006719500628290879],\"visible\":true,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_OK_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,38.22403126869862,34.52590128534215,3.6981299833564676,61.77596873130138,46.26001094502716,9.935711953672879,36.32429899135428,26.887957746762808,9.436341244591473,15.515957786274221,14.642210161070759,5.609785241815078,0.0,0.0,6.467583067568174,0.2592074456386119,2.3056344060488954,0.8737476252034633,0.024259092830600293,0.0,0.0,0.5358927356477261,0.23916538475389545,0.07443041197124135],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_OK_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,8.306799111230214,7.470507149665248,0.8362919615649669,91.69320088876977,90.83194911546512,42.20149659594644,48.63045251951868,26.823685904957838,21.80676661456084,0.8612517733046602,0.8223977511156931,0.29017634811587545,0.0,0.0,0.3509135061063052,0.05331808474412748,0.12798981214938507,0.03885402218896693,0.004105108758045333,0.0,0.0,0.019582744072792438,0.015166169358129155,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_OK_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,8.26139640011697,7.62752381490863,0.6338725852083402,91.738603599883,91.33143873183678,35.94969691434418,55.381741817492596,25.415592534709347,29.96614928278325,0.40716486804624363,0.39697949858457643,0.11352019184330467,0.0,0.0019675888621486755,0.17228458478364977,0.022271085593576524,0.08693604750189678,0.010185369461667185,0.0,0.0,0.0,0.0,0.00779135777356236,0.002394011688104825],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_OK_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,6.514604766160911,6.144095633691072,0.3705091324698389,93.48539523383909,92.9028420405862,43.774796042285715,49.12804599830048,25.423583054154044,23.70446294414643,0.5825531932528977,0.5607205571228371,0.17739922153532917,0.0,0.0,0.26261646734296856,0.013856092759940224,0.10684877548459915,0.021832636130060618,0.0,0.0,0.0,0.003591309023726093,0.018241327106334523,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_OK_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,7.979319264823211,7.368844562044624,0.6104747027785868,92.02068073517681,91.28389057710793,39.70533377402447,51.57855680308345,25.69848116479319,25.88007563829026,0.7367901580688809,0.703813410783785,0.24413756934888398,0.0,0.0007062893326559836,0.30949341574204464,0.02717249700358721,0.12230363935661319,0.032976747285095906,0.0013858224309029783,0.0,0.0,0.015433195338737564,0.013839926359751913,0.0023178031557034534],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_PK_0veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,35.95447816967149,29.87839497870135,6.076083190970141,64.04552183032852,44.67150625351122,16.12894608973716,28.542560163774056,22.4294149623197,6.113145201454356,19.374015576817317,18.91222849834537,7.047153628389663,0.0,0.1430242728180409,8.930339656544245,0.4044129585128949,2.3872979820805247,0.4617870784719479,0.16514411780220248,0.0,0.0,0.2966429606697454,0.0,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_PK_1veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,8.813109758881387,7.836708889471968,0.9764008694094187,91.18689024111859,90.44422534630813,46.67015771053187,43.77406763577627,22.30861016659123,21.46545746918504,0.742664894810476,0.6819270461887967,0.23045563349119677,0.0,0.008780348622160757,0.2760421386309096,0.1017535640918547,0.06489536135267487,0.06073784862167929,0.0,0.0,0.0,0.022152427614803145,0.03858542100687615,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_PK_2veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,6.511906719525884,6.02761571604158,0.484291003484304,93.48809328047409,92.93422263891283,38.217290007841484,54.716932631071344,25.097664130915437,29.61926850015591,0.5538706415612619,0.5034408503786302,0.22643408089714465,0.0,0.0,0.2229247009733593,0.025916829355662592,0.02816523915246363,0.050429791182631745,0.020238688793201776,0.0,0.0,0.015235181618475622,0.014955920770954347,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_PK_3veh\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,4.715445864322966,4.3524892114211315,0.3629566529018349,95.28455413567701,94.74116449374128,44.68995596296511,50.05120853077618,24.70215976624227,25.349048764533904,0.5433896419357409,0.48776643680097387,0.1996972207543102,0.0,0.0,0.15561864365936692,0.06007864403777859,0.0723719283495182,0.05562320513476698,0.0,0.0,0.0,0.01925542932954031,0.03636777580522667,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}},{\"branchvalues\":\"total\",\"labels\":[\"All Trips\",\"Non-motorized\",\"Walk\",\"Bike\",\"Motorized\",\"Auto\",\"Drive Alone\",\"Shared Ride\",\"SR2 (2 people)\",\"SR3 (3+ people)\",\"Transit\",\"Walk-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\",\"Drive-to-Transit\",\"Local Bus\",\"Core Bus\",\"Express Bus\",\"LRT\",\"CRT\",\"BRT\"],\"name\":\"NHB_PK_all\",\"parents\":[\"\",\"All Trips\",\"Non-motorized\",\"Non-motorized\",\"All Trips\",\"Motorized\",\"Auto\",\"Auto\",\"Shared Ride\",\"Shared Ride\",\"Motorized\",\"Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Walk-to-Transit\",\"Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\",\"Drive-to-Transit\"],\"textposition\":\"middle center\",\"values\":[100,6.484128508444495,5.913015578911235,0.5711129295332597,93.51587149155552,92.79386648283625,42.03546456019308,50.75840192264317,24.413471166797436,26.344930755845734,0.7220050087192528,0.6774695358397383,0.25889837772407287,0.0,0.004485557879122709,0.2916352766170844,0.04893796283682473,0.0735123607826337,0.044535472879514315,0.007468025859531691,0.0,0.0,0.017325213416437796,0.019742233603544827,0.0],\"visible\":false,\"type\":\"treemap\",\"root\":{\"color\":\"lightgrey\"}}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30}}},\"margin\":{\"t\":120,\"l\":25,\"r\":25,\"b\":25},\"updatemenus\":[{\"bgcolor\":\"white\",\"bordercolor\":\"gray\",\"borderwidth\":1,\"buttons\":[{\"args\":[{\"visible\":[true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBC - Daily - 0veh\"}],\"label\":\"HBC | Daily | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBC - Daily - 1veh\"}],\"label\":\"HBC | Daily | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBC - Daily - 2veh\"}],\"label\":\"HBC | Daily | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBC - Daily - 3veh\"}],\"label\":\"HBC | Daily | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBC - Daily - all\"}],\"label\":\"HBC | Daily | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - OK - 0veh\"}],\"label\":\"HBO | OK | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - OK - 1veh\"}],\"label\":\"HBO | OK | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - OK - 2veh\"}],\"label\":\"HBO | OK | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - OK - 3veh\"}],\"label\":\"HBO | OK | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - OK - all\"}],\"label\":\"HBO | OK | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - PK - 0veh\"}],\"label\":\"HBO | PK | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - PK - 1veh\"}],\"label\":\"HBO | PK | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - PK - 2veh\"}],\"label\":\"HBO | PK | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - PK - 3veh\"}],\"label\":\"HBO | PK | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBO - PK - all\"}],\"label\":\"HBO | PK | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBSch - Daily - 0veh\"}],\"label\":\"HBSch | Daily | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBSch - Daily - 1veh\"}],\"label\":\"HBSch | Daily | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBSch - Daily - 2veh\"}],\"label\":\"HBSch | Daily | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBSch - Daily - 3veh\"}],\"label\":\"HBSch | Daily | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBSch - Daily - all\"}],\"label\":\"HBSch | Daily | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - OK - 0veh\"}],\"label\":\"HBW | OK | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - OK - 1veh\"}],\"label\":\"HBW | OK | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - OK - 2veh\"}],\"label\":\"HBW | OK | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - OK - 3veh\"}],\"label\":\"HBW | OK | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - OK - all\"}],\"label\":\"HBW | OK | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - PK - 0veh\"}],\"label\":\"HBW | PK | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - PK - 1veh\"}],\"label\":\"HBW | PK | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - PK - 2veh\"}],\"label\":\"HBW | PK | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - PK - 3veh\"}],\"label\":\"HBW | PK | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: HBW - PK - all\"}],\"label\":\"HBW | PK | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - OK - 0veh\"}],\"label\":\"NHB | OK | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - OK - 1veh\"}],\"label\":\"NHB | OK | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - OK - 2veh\"}],\"label\":\"NHB | OK | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - OK - 3veh\"}],\"label\":\"NHB | OK | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - OK - all\"}],\"label\":\"NHB | OK | all\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - PK - 0veh\"}],\"label\":\"NHB | PK | 0veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - PK - 1veh\"}],\"label\":\"NHB | PK | 1veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false]},{\"title\":\"Mode Choice Hierarchy: NHB - PK - 2veh\"}],\"label\":\"NHB | PK | 2veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false]},{\"title\":\"Mode Choice Hierarchy: NHB - PK - 3veh\"}],\"label\":\"NHB | PK | 3veh\",\"method\":\"update\"},{\"args\":[{\"visible\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true]},{\"title\":\"Mode Choice Hierarchy: NHB - PK - all\"}],\"label\":\"NHB | PK | all\",\"method\":\"update\"}],\"direction\":\"down\",\"showactive\":true,\"x\":0.5,\"xanchor\":\"center\",\"y\":1.15,\"yanchor\":\"top\"}],\"title\":{\"text\":\"Mode Choice Hierarchy: HBW - PK - all\"},\"height\":800},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('0f416688-86aa-4257-b7be-e7188cf5aa98');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n## Output Folder\n\n::: {#3e075e58 .cell execution_count=38}\n``` {.python .cell-code}\n# Create output directory if it doesn't exist\noutput_dir = Path(\"_output\")\noutput_dir.mkdir(parents=True, exist_ok=True)\n\nprint(\"=\" * 80)\nprint(\"EXPORTING CALIBRATION TARGET FILES\")\nprint(\"=\" * 80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n================================================================================\nEXPORTING CALIBRATION TARGET FILES\n================================================================================\n```\n:::\n:::\n\n\n## Helper Functions\n\n### Extract Values\n\n::: {#fa8e269b .cell execution_count=39}\n``` {.python .cell-code}\ndef extract_values(df, purpose, period, pattern, include_veh_categories=True):\n    \"\"\"\n    Extract values from dataframe for given purpose/period matching a pattern.\n\n    Parameters:\n    -----------\n    df : DataFrame\n        DataFrame with MultiIndex columns (purpose, period)\n    purpose : str\n        Purpose to filter (e.g., 'HBW', 'HBO')\n    period : str\n        Period to filter (e.g., 'PK', 'OK', 'Daily')\n    pattern : str\n        Pattern to match in index (e.g., 'motor', 'bike', 'transit')\n    include_veh_categories : bool\n        If True, include all vehicle categories. If False, only include '_all' and strip suffix.\n\n    Returns:\n    --------\n    dict : {variable_name: value}\n    \"\"\"\n    results = {}\n\n    # Check if column exists\n    if (purpose, period) not in df.columns:\n        return results\n\n    # Filter rows matching pattern\n    mask = df.index.str.contains(pattern)\n\n    for idx in df[mask].index:\n        value = df.loc[idx, (purpose, period)]\n\n        if include_veh_categories:\n            # Include all vehicle categories as-is\n            results[idx] = value\n        else:\n            # Only include '_all' suffix and strip it\n            if idx.endswith('_all'):\n                # Remove '_all' suffix\n                var_name = idx.rsplit('_', 1)[0]\n                results[var_name] = value\n\n    return results\n```\n:::\n\n\n### Export Function\n\n::: {#505ebe7a .cell execution_count=40}\n``` {.python .cell-code}\ndef export_calib_file(purpose, period, include_veh_categories=True):\n    \"\"\"\n    Export calibration target file for a given purpose and period.\n\n    Parameters:\n    -----------\n    purpose : str\n        Trip purpose (HBW, HBO, NHB, HBC, HBSch)\n    period : str\n        Time period (PK, OK, Daily)\n    include_veh_categories : bool\n        If True, include vehicle category breakdowns (_0veh, _1veh, etc.)\n        If False, only use aggregate values without vehicle suffix\n    \"\"\"\n\n    # Determine file period (Daily becomes 'pk' for HBC/HBSch)\n    file_period = 'pk' if period == 'Daily' else period.lower()\n\n    # Determine display period for header\n    display_period = file_period.capitalize()\n    # display_period = 'Pk' if period == 'PK' or period == 'Daily' else 'Ok'\n\n    filename = f\"calib_target_{purpose.lower()}_{file_period}.txt\"\n    filepath = os.path.join(output_dir, filename)\n\n    print(f\"\\nCreating {filename}... (Vehicle categories: {'Yes' if include_veh_categories else 'No'})\")\n\n    with open(filepath, 'w') as f:\n        # Write header\n        f.write(f\";Calibration target values - {purpose} {display_period}\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # Write disclaimer\n        f.write(f\";Note: Not all of the variables listed below are used directly in the Mode Choice model. Some are included solely for verification and cross-checking purposes.\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 1: Motorized vs Non-motorized (within total trips)\n        # =====================================================================\n        f.write(\";relative within total trips\\t\\t\\n\")\n\n        # Non-motorized shares only\n        nonmotorized = extract_values(df_alltrips_cat, purpose, period, 'nonmotor_', include_veh_categories)\n        if nonmotorized:\n            f.write(\"  ;nonmotorized shares \\t\\t\\n\")\n            for var, val in sorted(nonmotorized.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n        f.write(\"\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 2: Walk vs Bike (within nonmotorized)\n        # =====================================================================\n        f.write(\";relative within nonmotorized\\t\\t\\n\")\n\n        # Walk shares\n        walk = extract_values(df_nonmotorized_cat, purpose, period, 'walk_', include_veh_categories)\n        if walk:\n            f.write(\"  ;walk shares \\t\\t\\n\")\n            for var, val in sorted(walk.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\"\\t\\t\\n\")\n\n        # Bike shares\n        bike = extract_values(df_nonmotorized_cat, purpose, period, 'bike_', include_veh_categories)\n        if bike:\n            f.write(\"  ;bike shares \\t\\t\\n\")\n            for var, val in sorted(bike.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n        f.write(\"\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 3: Drive Alone vs Shared Ride (within auto)\n        # =====================================================================\n        f.write(\";relative within auto\\t\\t\\n\")\n\n        # Drive alone shares\n        alone = extract_values(df_auto_riders, purpose, period, 'alone_', include_veh_categories)\n        if alone:\n            f.write(\"  ;drive alone shares \\t\\t\\n\")\n            for var, val in sorted(alone.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\"\\t\\t\\n\")\n\n        # Shared ride shares\n        shared = extract_values(df_auto_riders, purpose, period, 'shared_', include_veh_categories)\n        if shared:\n            f.write(\"  ;shared ride shares \\t\\t\\n\")\n            for var, val in sorted(shared.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n        f.write(\"\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 4: SR2 vs SR3 (within shared ride)\n        # =====================================================================\n        f.write(\";relative within shared ride\\t\\t\\n\")\n\n        # SR2 shares\n        sr2 = extract_values(df_shared_by_person, purpose, period, 'sr2_', include_veh_categories)\n        if sr2:\n            f.write(\"  ;sr2 shares \\t\\t\\n\")\n            for var, val in sorted(sr2.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\"\\t\\t\\n\")\n\n        # SR3 shares\n        sr3 = extract_values(df_shared_by_person, purpose, period, 'sr3_', include_veh_categories)\n        if sr3:\n            f.write(\"  ;sr3 shares \\t\\t\\n\")\n            for var, val in sorted(sr3.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n        f.write(\"\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 5: Auto vs Transit (within motorized)\n        # =====================================================================\n        f.write(\";relative within motorized\\t\\t\\n\")\n\n        # Auto shares\n        auto = extract_values(df_motorized_cat, purpose, period, 'auto_', include_veh_categories)\n        if auto:\n            f.write(\"  ;auto shares \\t\\t\\n\")\n            for var, val in sorted(auto.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\"\\t\\t\\n\")\n\n        # Transit shares\n        transit = extract_values(df_motorized_cat, purpose, period, 'transit_', include_veh_categories)\n        if transit:\n            f.write(\"  ;transit shares \\t\\t\\n\")\n            for var, val in sorted(transit.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\" \\t\\t\\n\")\n\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 6: Transit by Service Type (within transit)\n        # =====================================================================\n        f.write(\";relative within transit\\t\\t\\n\")\n\n        # Get all transit service types\n        service_types = ['local', 'core', 'brt', 'lrt', 'express', 'crt']\n        transit_services = {}\n        for service in service_types:\n            vals = extract_values(df_transit_by_service, purpose, period, f'{service}_', include_veh_categories)\n            transit_services.update(vals)\n\n        if transit_services:\n            for var, val in sorted(transit_services.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\"  \\t\\t\\n\")\n\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 7: Walk vs Drive Access (within transit)\n        # =====================================================================\n        f.write(\";relative within transit\\t\\t\\n\")\n\n        # Walk access shares\n        walkacc = extract_values(df_transit_by_access, purpose, period, 'walkacc_', include_veh_categories)\n        if walkacc:\n            f.write(\"  ;walk-to-transit shares \\t\\t\\n\")\n            for var, val in sorted(walkacc.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n            f.write(\"\\t\\t\\n\")\n\n        # Drive access shares\n        driveacc = extract_values(df_transit_by_access, purpose, period, 'driveacc_', include_veh_categories)\n        if driveacc:\n            f.write(\"  ;drive-to-transit shares \\t\\t\\n\")\n            for var, val in sorted(driveacc.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n        f.write(\"\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 8: Walk-to-Transit by Service (within walkacc)\n        # =====================================================================\n        f.write(\";relative within walkacc\\t\\t\\n\")\n\n        # Get all walk-to-transit service types\n        walk_services = {}\n        for service in ['wlocal', 'wcore', 'wbrt', 'wlrt', 'wexpress', 'wcrt']:\n            vals = extract_values(df_walk_to_transit, purpose, period, f'{service}_', include_veh_categories)\n            walk_services.update(vals)\n\n        if walk_services:\n            for var, val in sorted(walk_services.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n        f.write(\"\\t\\t\\n\")\n        f.write(\"\\t\\t\\n\")\n\n        # =====================================================================\n        # SECTION 9: Drive-to-Transit by Service (within driveacc)\n        # =====================================================================\n        f.write(\";relative within driveacc\\t\\t\\n\")\n\n        # Get all drive-to-transit service types\n        drive_services = {}\n        for service in ['dlocal', 'dcore', 'dbrt', 'dlrt', 'dexpress', 'dcrt']:\n            vals = extract_values(df_drive_to_transit, purpose, period, f'{service}_', include_veh_categories)\n            drive_services.update(vals)\n\n        if drive_services:\n            for var, val in sorted(drive_services.items()):\n                f.write(f\"  {var:<30}\\t=\\t{val:.4f}\\n\")\n\n    print(f\"  ‚úÖ Written to {filepath}\")\n```\n:::\n\n\n## Export All Files\n\n::: {#b60f5a8e .cell execution_count=41}\n``` {.python .cell-code}\n# Define purposes and their configuration\nexport_config = {\n    'HBW':   {'periods': ['PK', 'OK'], 'include_veh': True},\n    'HBO':   {'periods': ['PK', 'OK'], 'include_veh': True},\n    'NHB':   {'periods': ['PK', 'OK'], 'include_veh': True}, # False\n    'HBC':   {'periods': ['Daily'],    'include_veh': True}, # False\n    'HBSch': {'periods': ['Daily'],    'include_veh': True}  # False\n}\n\nfor purpose, config in export_config.items():\n    for period in config['periods']:\n        export_calib_file(purpose, period, include_veh_categories=config['include_veh'])\n\nprint(\"\\n\" + \"=\" * 80)\nprint(\"‚úÖ EXPORT COMPLETE!\")\nprint(\"=\" * 80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCreating calib_target_hbw_pk.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_hbw_pk.txt\n\nCreating calib_target_hbw_ok.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_hbw_ok.txt\n\nCreating calib_target_hbo_pk.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_hbo_pk.txt\n\nCreating calib_target_hbo_ok.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_hbo_ok.txt\n\nCreating calib_target_nhb_pk.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_nhb_pk.txt\n\nCreating calib_target_nhb_ok.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_nhb_ok.txt\n\nCreating calib_target_hbc_pk.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_hbc_pk.txt\n\nCreating calib_target_hbsch_pk.txt... (Vehicle categories: Yes)\n  ‚úÖ Written to _output\\calib_target_hbsch_pk.txt\n\n================================================================================\n‚úÖ EXPORT COMPLETE!\n================================================================================\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n</script>\n<script type=\"module\">import \"https://cdn.plot.ly/plotly-3.2.0.min\"</script>\n\n"
      ]
    }
  }
}