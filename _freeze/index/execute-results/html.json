{
  "hash": "5598dbd63c9897650962271215f6d091",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Calculating the Mode Choice Calibration Parameters\nsubtitle: Using Household Travel Survey and UTA On-Board Survey Data\ndescription: Lorem Ipsum\nauthor:\n - name: Pukar Bhandari\n   email: pukar.bhandari@wfrc.utah.gov\n   affiliation:\n     - name: Wasatch Front Regional Council\n       url: \"https://wfrc.utah.gov/\"\ndate: \"2025-11-03\"\n---\n\n# Setup Environment\n\nThis section prepares the Python environment with all necessary libraries and configurations. We'll import data manipulation libraries (pandas, numpy), and visualization tools (matplotlib, seaborn).\n\n## Install Libraries\n\n```python\n!conda install -c conda-forge numpy pandas matplotlib seaborn requests pathlib BigQuery\n```\n\n## Import Libraries\n\n::: {#2dab6701 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport importlib.util\nfrom pathlib import Path\nimport sys\nimport os\nimport requests\nimport io\n\nfrom dotenv import load_dotenv\nload_dotenv()\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nTrue\n```\n:::\n:::\n\n\n## Environment Variables\n\n\n\n## Helper Functions\n\n::: {#5b189422 .cell execution_count=2}\n``` {.python .cell-code}\ndef fetch_github(\n    url: str,\n    mode: str = \"private\",\n    token_env_var: str = \"GITHUB_TOKEN\"\n) -> requests.Response:\n    \"\"\"\n    Fetch content from GitHub repositories.\n\n    Args:\n        url: GitHub raw URL (e.g., https://raw.githubusercontent.com/...)\n        mode: \"public\" for public repos, \"private\" for private repos requiring authentication\n        token_env_var: Name of environment variable containing GitHub token (default: GITHUB_TOKEN)\n\n    Returns:\n        requests.Response object\n\n    Raises:\n        ValueError: If token is missing for private mode or invalid mode\n        requests.HTTPError: If request fails\n    \"\"\"\n    # Validate mode\n    if mode not in [\"public\", \"private\"]:\n        raise ValueError(f\"mode must be 'public' or 'private', got '{mode}'\")\n\n    if mode == \"public\":\n        response = requests.get(url, timeout=30)\n    else:\n        token = os.getenv(token_env_var)\n        if not token:\n            raise ValueError(\n                f\"GitHub token not found in environment variable '{token_env_var}'. \"\n                f\"Check your .env file has: {token_env_var}=your_token_here\"\n            )\n\n        headers = {\n            'Authorization': f'token {token}',\n            'Accept': 'application/vnd.github.v3.raw'\n        }\n        response = requests.get(url, headers=headers, timeout=30)\n\n    response.raise_for_status()\n    return response\n```\n:::\n\n\n::: {#eb07dd19 .cell execution_count=3}\n``` {.python .cell-code}\ndef calculate_mode_shares(\n    df,\n    groupby_cols=['Veh_Cat3p', 'Purp5_text', 'PK_OK'],\n    mode_col='Linked_Mode_txt',\n    filter_conditions=None,\n    mode_mapping=None,\n    prefix='calib_share',\n    include_daily_only_purposes=['HBC', 'HBSch']\n):\n    \"\"\"\n    Calculate mode shares with flexible grouping and filtering.\n\n    Parameters:\n    -----------\n    df : DataFrame\n        Input dataframe (OBS or HTS)\n    groupby_cols : list\n        Columns to group by (e.g., ['Veh_Cat3p', 'Purp5_text', 'PK_OK'])\n    mode_col : str\n        Column containing mode information\n    filter_conditions : dict or None\n        Dictionary of {column: value} to filter data before calculation\n        Example: {'Ac_Mode_Model': 'Walk'} for walk-to-transit only\n    mode_mapping : dict or None\n        Map mode values to standard names\n        Example: {'LCL': 'local', 'COR': 'core', ...}\n    prefix : str\n        Prefix for output column names (e.g., 'calib_share')\n    include_daily_only_purposes : list\n        Purposes to aggregate as 'Daily' instead of Peak/OffPeak\n\n    Returns:\n    --------\n    DataFrame with columns: Veh_Cat (0, 1, 2, all) x Purpose x Peak/OffPeak x Mode\n    \"\"\"\n\n    # Make a copy and filter out MicroTransit\n    df_work = df.copy()\n    if 'Mode_Fin' in df_work.columns:\n        df_work = df_work[df_work['Mode_Fin'] != 1]  # Remove MicroTransit\n\n    # Apply additional filters if specified\n    if filter_conditions:\n        for col, val in filter_conditions.items():\n            df_work = df_work[df_work[col] == val]\n\n    # Apply mode mapping if provided\n    if mode_mapping and mode_col in df_work.columns:\n        df_work[mode_col] = df_work[mode_col].map(mode_mapping)\n\n    # Separate daily-only purposes from peak/offpeak purposes\n    df_daily_only = df_work[df_work['Purp5_text'].isin(include_daily_only_purposes)]\n    df_peak_offpeak = df_work[~df_work['Purp5_text'].isin(include_daily_only_purposes)]\n\n    results = []\n\n    # Process Peak/OffPeak purposes\n    if len(df_peak_offpeak) > 0:\n        # Calculate shares for each vehicle category\n        for veh_cat in [0, 1, 2]:\n            df_veh = df_peak_offpeak[df_peak_offpeak['Veh_Cat3p'] == veh_cat]\n\n            for purpose in df_veh['Purp5_text'].unique():\n                df_purp = df_veh[df_veh['Purp5_text'] == purpose]\n\n                for pk in df_purp['PK_OK'].unique():\n                    df_subset = df_purp[df_purp['PK_OK'] == pk]\n\n                    if len(df_subset) > 0:\n                        # Calculate mode shares\n                        mode_counts = df_subset[mode_col].value_counts()\n                        total = mode_counts.sum()\n                        mode_shares = (mode_counts / total).to_dict()\n\n                        # Add to results\n                        for mode, share in mode_shares.items():\n                            results.append({\n                                'Veh_Cat': veh_cat,\n                                'Purpose': purpose,\n                                'Period': pk,\n                                'Mode': mode,\n                                'Share': share\n                            })\n\n        # Calculate shares for \"all\" vehicle categories\n        for purpose in df_peak_offpeak['Purp5_text'].unique():\n            df_purp = df_peak_offpeak[df_peak_offpeak['Purp5_text'] == purpose]\n\n            for pk in df_purp['PK_OK'].unique():\n                df_subset = df_purp[df_purp['PK_OK'] == pk]\n\n                if len(df_subset) > 0:\n                    mode_counts = df_subset[mode_col].value_counts()\n                    total = mode_counts.sum()\n                    mode_shares = (mode_counts / total).to_dict()\n\n                    for mode, share in mode_shares.items():\n                        results.append({\n                            'Veh_Cat': 'all',\n                            'Purpose': purpose,\n                            'Period': pk,\n                            'Mode': mode,\n                            'Share': share\n                        })\n\n    # Process Daily-only purposes\n    if len(df_daily_only) > 0:\n        # Calculate shares for each vehicle category\n        for veh_cat in [0, 1, 2]:\n            df_veh = df_daily_only[df_daily_only['Veh_Cat3p'] == veh_cat]\n\n            for purpose in df_veh['Purp5_text'].unique():\n                df_purp = df_veh[df_veh['Purp5_text'] == purpose]\n\n                if len(df_purp) > 0:\n                    mode_counts = df_purp[mode_col].value_counts()\n                    total = mode_counts.sum()\n                    mode_shares = (mode_counts / total).to_dict()\n\n                    for mode, share in mode_shares.items():\n                        results.append({\n                            'Veh_Cat': veh_cat,\n                            'Purpose': purpose,\n                            'Period': 'Daily',\n                            'Mode': mode,\n                            'Share': share\n                        })\n\n        # Calculate shares for \"all\" vehicle categories\n        for purpose in df_daily_only['Purp5_text'].unique():\n            df_purp = df_daily_only[df_daily_only['Purp5_text'] == purpose]\n\n            if len(df_purp) > 0:\n                mode_counts = df_purp[mode_col].value_counts()\n                total = mode_counts.sum()\n                mode_shares = (mode_counts / total).to_dict()\n\n                for mode, share in mode_shares.items():\n                    results.append({\n                        'Veh_Cat': 'all',\n                        'Purpose': purpose,\n                        'Period': 'Daily',\n                        'Mode': mode,\n                        'Share': share\n                    })\n\n    # Convert to DataFrame\n    df_result = pd.DataFrame(results)\n\n    # Pivot to wide format matching target structure\n    if len(df_result) > 0:\n        df_wide = df_result.pivot_table(\n            index=['Veh_Cat', 'Mode'],\n            columns=['Purpose', 'Period'],\n            values='Share',\n            fill_value=0\n        )\n\n        # Flatten column names\n        df_wide.columns = [f\"{col[0]}_{col[1]}\" for col in df_wide.columns]\n        df_wide = df_wide.reset_index()\n\n        # Create row names matching target format\n        df_wide['variable'] = df_wide.apply(\n            lambda row: f\"{prefix}_{row['Mode'].lower()}_{row['Veh_Cat']}veh\"\n            if row['Veh_Cat'] != 'all'\n            else f\"{prefix}_{row['Mode'].lower()}_all\",\n            axis=1\n        )\n\n        df_wide = df_wide.drop(['Veh_Cat', 'Mode'], axis=1)\n        df_wide = df_wide.set_index('variable')\n\n        return df_wide\n    else:\n        return pd.DataFrame()\n```\n:::\n\n\n## Setup BigQuery\n\n\n\n::: {#2ca83b28 .cell execution_count=5}\n``` {.python .cell-code}\n# # Import global TDM functions from remote 'Resource' repo\n\n# Fetch and import BigQuery module\nresponse = fetch_github(\n    'https://raw.githubusercontent.com/WFRCAnalytics/Resources/refs/heads/master/2-Python/global-functions/BigQuery.py',\n    mode=\"public\"\n)\n\nBigQuery = importlib.util.module_from_spec(importlib.util.spec_from_loader('BigQuery', loader=None))\nexec(response.text, BigQuery.__dict__)\n\n# Initiatlize BigQuery Client\nclient = BigQuery.getBigQueryClient_Confidential2023UtahHTS()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npukar.bhandari\nC:/Users/Pukar.Bhandari/.private/confidential-2023-utah-hts-5fd7ddd219a7.json\n```\n:::\n:::\n\n\n# Load Data\n\n## UTA On-Board Survey\n\n::: {#5a0a5a40 .cell execution_count=6}\n``` {.python .cell-code}\n# Read Linked UTA On-Board Survey Data directly from GitHub repo\nresponse = fetch_github(\n    \"https://raw.githubusercontent.com/WFRCAnalytics/DATA-OBS-Prep-For-TDM/refs/heads/main/_output/UTA_OBS_2024_Linked.csv\",\n    mode = \"private\"\n)\n\ndf_obs_linked = pd.read_csv(io.StringIO(response.text))\ndf_obs_linked\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\Pukar.Bhandari\\AppData\\Local\\Temp\\ipykernel_32324\\4156658631.py:7: DtypeWarning: Columns (8,24,32,37,54,132,137,174) have mixed types. Specify dtype option on import or set low_memory=False.\n  df_obs_linked = pd.read_csv(io.StringIO(response.text))\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ID</th>\n      <th>DATE_COMPLETED</th>\n      <th>DATE_TYPE</th>\n      <th>ROUTE_DIRECTION_Code</th>\n      <th>ROUTE_DIRECTION</th>\n      <th>ROUTE_DIRECTION_Other</th>\n      <th>HOME_ADDRESS_CITY</th>\n      <th>HOME_ADDRESS_STATE</th>\n      <th>HOME_ADDRESS_ZIP</th>\n      <th>HOME_ADDRESS_LAT</th>\n      <th>...</th>\n      <th>p_Stop_lat</th>\n      <th>p_Stop_lon</th>\n      <th>a_Stop_lat</th>\n      <th>a_Stop_lon</th>\n      <th>p_Stop_N</th>\n      <th>a_Stop_N</th>\n      <th>access_dist</th>\n      <th>access_time</th>\n      <th>egress_dist</th>\n      <th>egress_time</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>5948</td>\n      <td>2/27/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_2_00</td>\n      <td>2 200 SOUTH - TO U HOSPITAL</td>\n      <td>NaN</td>\n      <td>Clearfield</td>\n      <td>UT</td>\n      <td>84015</td>\n      <td>41.119565</td>\n      <td>...</td>\n      <td>41.118979</td>\n      <td>-112.025922</td>\n      <td>40.769221</td>\n      <td>-111.898663</td>\n      <td>27702</td>\n      <td>25493</td>\n      <td>0.37</td>\n      <td>0.148000</td>\n      <td>0.68</td>\n      <td>0.27200</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>6067</td>\n      <td>2/27/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_47_00</td>\n      <td>47 4700 SOUTH - TO W VALLEY CTL</td>\n      <td>NaN</td>\n      <td>West Valley City</td>\n      <td>UT</td>\n      <td>84119</td>\n      <td>40.689590</td>\n      <td>...</td>\n      <td>40.689384</td>\n      <td>-111.967476</td>\n      <td>40.660941</td>\n      <td>-111.899443</td>\n      <td>23195</td>\n      <td>23685</td>\n      <td>0.56</td>\n      <td>0.224000</td>\n      <td>0.24</td>\n      <td>0.09600</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>6069</td>\n      <td>3/16/2024</td>\n      <td>Saturday</td>\n      <td>UTA_1_750_01</td>\n      <td>FRONTRUNNER 750 - SOUTHBOUND</td>\n      <td>NaN</td>\n      <td>Ogden</td>\n      <td>UT</td>\n      <td>84401</td>\n      <td>41.186697</td>\n      <td>...</td>\n      <td>41.188757</td>\n      <td>-112.039378</td>\n      <td>40.784356</td>\n      <td>-111.982117</td>\n      <td>10042</td>\n      <td>15093</td>\n      <td>1.36</td>\n      <td>0.050671</td>\n      <td>0.20</td>\n      <td>0.08000</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>6073</td>\n      <td>2/28/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_750_01</td>\n      <td>FRONTRUNNER 750 - SOUTHBOUND</td>\n      <td>NaN</td>\n      <td>Ogden</td>\n      <td>UT</td>\n      <td>84401</td>\n      <td>41.236749</td>\n      <td>...</td>\n      <td>41.188757</td>\n      <td>-112.039378</td>\n      <td>40.659758</td>\n      <td>-111.896432</td>\n      <td>10042</td>\n      <td>10016</td>\n      <td>4.17</td>\n      <td>0.136991</td>\n      <td>1.66</td>\n      <td>0.07316</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>6077</td>\n      <td>2/28/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_47_00</td>\n      <td>47 4700 SOUTH - TO W VALLEY CTL</td>\n      <td>NaN</td>\n      <td>West Valley City</td>\n      <td>UT</td>\n      <td>84119</td>\n      <td>40.669687</td>\n      <td>...</td>\n      <td>40.667711</td>\n      <td>-111.961123</td>\n      <td>40.681907</td>\n      <td>-112.024041</td>\n      <td>22922</td>\n      <td>22421</td>\n      <td>0.25</td>\n      <td>0.100000</td>\n      <td>0.49</td>\n      <td>0.19600</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>13790</th>\n      <td>30339</td>\n      <td>4/26/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_704_01</td>\n      <td>TRAX GREEN LINE 704 - TO AIRPORT</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84116</td>\n      <td>40.772420</td>\n      <td>...</td>\n      <td>40.771536</td>\n      <td>-111.945736</td>\n      <td>40.771502</td>\n      <td>-111.914486</td>\n      <td>15101</td>\n      <td>15122</td>\n      <td>0.31</td>\n      <td>0.124000</td>\n      <td>0.17</td>\n      <td>0.06800</td>\n    </tr>\n    <tr>\n      <th>13791</th>\n      <td>30340</td>\n      <td>4/26/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_704_00</td>\n      <td>TRAX GREEN LINE 704 - TO WEST VALLEY</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84116</td>\n      <td>40.771361</td>\n      <td>...</td>\n      <td>40.771505</td>\n      <td>-111.915361</td>\n      <td>40.750058</td>\n      <td>-111.896818</td>\n      <td>25266</td>\n      <td>15109</td>\n      <td>0.30</td>\n      <td>0.120000</td>\n      <td>1.21</td>\n      <td>0.48400</td>\n    </tr>\n    <tr>\n      <th>13792</th>\n      <td>30341</td>\n      <td>4/26/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_704_00</td>\n      <td>TRAX GREEN LINE 704 - TO WEST VALLEY</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84116</td>\n      <td>40.773232</td>\n      <td>...</td>\n      <td>40.771505</td>\n      <td>-111.915361</td>\n      <td>40.725345</td>\n      <td>-111.877499</td>\n      <td>25266</td>\n      <td>24968</td>\n      <td>0.19</td>\n      <td>0.076000</td>\n      <td>0.86</td>\n      <td>0.34400</td>\n    </tr>\n    <tr>\n      <th>13793</th>\n      <td>1000002</td>\n      <td>2/29/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_701_00</td>\n      <td>TRAX BLUE LINE 701 - TO DRAPER</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84111</td>\n      <td>40.751607</td>\n      <td>...</td>\n      <td>40.755113</td>\n      <td>-111.891095</td>\n      <td>40.674859</td>\n      <td>-111.943134</td>\n      <td>15123</td>\n      <td>23342</td>\n      <td>0.33</td>\n      <td>0.132000</td>\n      <td>0.29</td>\n      <td>0.11600</td>\n    </tr>\n    <tr>\n      <th>13794</th>\n      <td>1000004</td>\n      <td>2/29/2024</td>\n      <td>Weekday</td>\n      <td>UTA_1_701_00</td>\n      <td>TRAX BLUE LINE 701 - TO DRAPER</td>\n      <td>NaN</td>\n      <td>Salt Lake City</td>\n      <td>UT</td>\n      <td>84109</td>\n      <td>40.722068</td>\n      <td>...</td>\n      <td>40.725878</td>\n      <td>-111.830935</td>\n      <td>40.525496</td>\n      <td>-111.858805</td>\n      <td>25663</td>\n      <td>15041</td>\n      <td>0.79</td>\n      <td>0.316000</td>\n      <td>0.19</td>\n      <td>0.07600</td>\n    </tr>\n  </tbody>\n</table>\n<p>13795 rows Ã— 301 columns</p>\n</div>\n```\n:::\n:::\n\n\n## Household Travel Survey\n\n::: {#c7c1ba1b .cell execution_count=7}\n``` {.python .cell-code}\n# Load Linked Trips data from 2023 Household Travel Survey\ndf_hts_linked = client.query(\n    \"SELECT * FROM \" + 'wfrc-modeling-data.prd_tdm_hts_2023.trip_linked'\n).to_dataframe()\n\ndf_hts_linked\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>unique_id</th>\n      <th>linked_trip_id</th>\n      <th>hh_id</th>\n      <th>person_id</th>\n      <th>day_id</th>\n      <th>day_weight</th>\n      <th>person_num</th>\n      <th>day_num</th>\n      <th>participation_group</th>\n      <th>diary_platform</th>\n      <th>...</th>\n      <th>dCO_TAZID_USTMv3</th>\n      <th>pCO_TAZID_USTMv3</th>\n      <th>aCO_TAZID_USTMv3</th>\n      <th>oCO_TAZID_USTMv4</th>\n      <th>dCO_TAZID_USTMv4</th>\n      <th>pCO_TAZID_USTMv4</th>\n      <th>aCO_TAZID_USTMv4</th>\n      <th>pSUBAREAID</th>\n      <th>aSUBAREAID</th>\n      <th>trip_weight</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>5facab93-0b23-480f-b69a-70a9d611427c</td>\n      <td>2302328301010100</td>\n      <td>23023283</td>\n      <td>2302328301</td>\n      <td>230232830101</td>\n      <td>785.318580</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>browser</td>\n      <td>...</td>\n      <td>530200.0</td>\n      <td>530278.0</td>\n      <td>530200.0</td>\n      <td>530297.0</td>\n      <td>530323.0</td>\n      <td>530297.0</td>\n      <td>530323.0</td>\n      <td>3.0</td>\n      <td>3.0</td>\n      <td>785.318580</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>27d90255-4acc-42fb-82a7-62e249f739b8</td>\n      <td>2303463801020900</td>\n      <td>23034638</td>\n      <td>2303463801</td>\n      <td>230346380102</td>\n      <td>0.000000</td>\n      <td>1</td>\n      <td>2</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>490777.0</td>\n      <td>490777.0</td>\n      <td>490723.0</td>\n      <td>490750.0</td>\n      <td>490757.0</td>\n      <td>490757.0</td>\n      <td>490750.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3808484f-788b-48e5-a5e1-dba3eec264fa</td>\n      <td>2304417802020100</td>\n      <td>23044178</td>\n      <td>2304417802</td>\n      <td>230441780202</td>\n      <td>79.325700</td>\n      <td>2</td>\n      <td>2</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>350673.0</td>\n      <td>350673.0</td>\n      <td>350197.0</td>\n      <td>350197.0</td>\n      <td>350673.0</td>\n      <td>350673.0</td>\n      <td>350197.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>79.325700</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>76bc4c44-e8f4-47ff-9c3d-36959467a428</td>\n      <td>2305261901070200</td>\n      <td>23052619</td>\n      <td>2305261901</td>\n      <td>230526190107</td>\n      <td>508.569360</td>\n      <td>1</td>\n      <td>7</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>490774.0</td>\n      <td>490774.0</td>\n      <td>490723.0</td>\n      <td>490750.0</td>\n      <td>490754.0</td>\n      <td>490754.0</td>\n      <td>490750.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>508.569360</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4a68e37e-5f7e-4a2b-9448-08ec36f3d318</td>\n      <td>2307491602030100</td>\n      <td>23074916</td>\n      <td>2307491602</td>\n      <td>230749160203</td>\n      <td>0.000000</td>\n      <td>2</td>\n      <td>3</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>490497.0</td>\n      <td>490497.0</td>\n      <td>490632.0</td>\n      <td>490715.0</td>\n      <td>490455.0</td>\n      <td>490455.0</td>\n      <td>490715.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>13112</th>\n      <td>1019ad4d-6732-45a1-a991-e5a3be830883</td>\n      <td>2348141901030100</td>\n      <td>23481419</td>\n      <td>2348141901</td>\n      <td>234814190103</td>\n      <td>21.199747</td>\n      <td>1</td>\n      <td>3</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>350187.0</td>\n      <td>350187.0</td>\n      <td>350189.0</td>\n      <td>350189.0</td>\n      <td>350187.0</td>\n      <td>350187.0</td>\n      <td>350189.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>21.199747</td>\n    </tr>\n    <tr>\n      <th>13113</th>\n      <td>adfacfa2-2f88-462d-b7de-17066fa37ece</td>\n      <td>2348219501010100</td>\n      <td>23482195</td>\n      <td>2348219501</td>\n      <td>234821950101</td>\n      <td>68.644470</td>\n      <td>1</td>\n      <td>1</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>350562.0</td>\n      <td>350562.0</td>\n      <td>350562.0</td>\n      <td>350562.0</td>\n      <td>350562.0</td>\n      <td>350562.0</td>\n      <td>350562.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>68.644470</td>\n    </tr>\n    <tr>\n      <th>13114</th>\n      <td>5c5d7f99-8bb5-49bb-8eb0-2447e9f2abfc</td>\n      <td>2348502802010200</td>\n      <td>23485028</td>\n      <td>2348502802</td>\n      <td>234850280201</td>\n      <td>0.000000</td>\n      <td>2</td>\n      <td>1</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>351014.0</td>\n      <td>351203.0</td>\n      <td>351014.0</td>\n      <td>351203.0</td>\n      <td>351014.0</td>\n      <td>351203.0</td>\n      <td>351014.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>13115</th>\n      <td>e136d377-68a2-4086-8b89-3a030fdc1ab7</td>\n      <td>2348561501010100</td>\n      <td>23485615</td>\n      <td>2348561501</td>\n      <td>234856150101</td>\n      <td>32.566605</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>browser</td>\n      <td>...</td>\n      <td>350253.0</td>\n      <td>350368.0</td>\n      <td>350253.0</td>\n      <td>350368.0</td>\n      <td>350253.0</td>\n      <td>350368.0</td>\n      <td>350253.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>39.079926</td>\n    </tr>\n    <tr>\n      <th>13116</th>\n      <td>e1ba708e-8925-4357-9720-5dec0b126809</td>\n      <td>2348838901050200</td>\n      <td>23488389</td>\n      <td>2348838901</td>\n      <td>234883890105</td>\n      <td>22.466323</td>\n      <td>1</td>\n      <td>5</td>\n      <td>9</td>\n      <td>rmove</td>\n      <td>...</td>\n      <td>110049.0</td>\n      <td>110049.0</td>\n      <td>110053.0</td>\n      <td>110053.0</td>\n      <td>110049.0</td>\n      <td>110049.0</td>\n      <td>110053.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>22.466323</td>\n    </tr>\n  </tbody>\n</table>\n<p>232451 rows Ã— 109 columns</p>\n</div>\n```\n:::\n:::\n\n\n# Understanding Mode Hierarchy\n\n```{mermaid}\nflowchart LR\n  T[\"ðŸš¦ Total Trips\"]\n\n  %% Top-level split\n  T --> M[\"Motorized\"]\n  T --> NM[\"Non-motorized\"]\n\n  %% Motorized branch\n  subgraph S1[\"ðŸš— Motorized Transportation\"]\n    direction TB\n    M --> A[\"Auto\"]\n    M --> TR[\"Transit\"]\n\n    %% Auto\n    A --> DA[\"Drive alone\"]\n    A --> SR[\"Shared ride\"]\n    SR --> SR2[\"SR2<br/><i>2 people</i>\"]\n    SR --> SR3[\"SR3<br/><i>3+ people</i>\"]\n\n    %% Transit (two complementary views)\n    subgraph S1a[\"ðŸšŒ Transit â€“ By Service Type\"]\n      direction TB\n      TR --> TM[\"By service type\"]\n      TM --> LB[\"Local bus\"]\n      TM --> CB[\"Core bus\"]\n      TM --> EB[\"Express bus\"]\n      TM --> LRT[\"LRT<br/><i>light rail</i>\"]\n      TM --> CRT[\"CRT<br/><i>commuter rail</i>\"]\n      TM --> BRT[\"BRT<br/><i>bus rapid</i>\"]\n    end\n\n    subgraph S1b[\"ðŸš¶ðŸš— Transit â€“ By Access Type\"]\n      direction TB\n      TR --> TA[\"By access type\"]\n\n      %% Walk-to-transit\n      TA --> WTT[\"ðŸš¶ Walk-to-transit\"]\n      WTT --> WLB[\"Walk â†’ Local bus\"]\n      WTT --> WCB[\"Walk â†’ Core bus\"]\n      WTT --> WEB[\"Walk â†’ Express bus\"]\n      WTT --> WLRT[\"Walk â†’ LRT\"]\n      WTT --> WCRT[\"Walk â†’ CRT\"]\n      WTT --> WBRT[\"Walk â†’ BRT\"]\n\n      %% Drive-to-transit\n      TA --> DTT[\"ðŸš— Drive-to-transit\"]\n      DTT --> DLB[\"Drive â†’ Local bus\"]\n      DTT --> DCB[\"Drive â†’ Core bus\"]\n      DTT --> DEB[\"Drive â†’ Express bus\"]\n      DTT --> DLRT[\"Drive â†’ LRT\"]\n      DTT --> DCRT[\"Drive â†’ CRT\"]\n      DTT --> DBRT[\"Drive â†’ BRT\"]\n    end\n  end\n\n  %% Non-motorized branch\n  subgraph S2[\"ðŸš¶ Non-motorized Transportation\"]\n    direction TB\n    NM --> WALK[\"Walk\"]\n    NM --> BIKE[\"Bike\"]\n  end\n\n  %% Styling\n  classDef rootNode fill:#2c3e50,stroke:#34495e,stroke-width:3px,color:#fff,font-weight:bold,font-size:16px\n  classDef motorizedNode fill:#3498db,stroke:#2980b9,stroke-width:2px,color:#fff,font-weight:bold\n  classDef nonMotorizedNode fill:#27ae60,stroke:#229954,stroke-width:2px,color:#fff,font-weight:bold\n  classDef autoNode fill:#e67e22,stroke:#d35400,stroke-width:2px,color:#fff\n  classDef transitNode fill:#9b59b6,stroke:#8e44ad,stroke-width:2px,color:#fff\n  classDef walkTransitNode fill:#1abc9c,stroke:#16a085,stroke-width:2px,color:#fff\n  classDef driveTransitNode fill:#e74c3c,stroke:#c0392b,stroke-width:2px,color:#fff\n  classDef leafNode fill:#ecf0f1,stroke:#95a5a6,stroke-width:1px,color:#2c3e50\n  classDef subgraphStyle fill:#f8f9fa,stroke:#dee2e6,stroke-width:2px\n\n  class T rootNode\n  class M motorizedNode\n  class NM nonMotorizedNode\n  class A,DA,SR,SR2,SR3 autoNode\n  class TR,TM,TA transitNode\n  class WTT,WLB,WCB,WEB,WLRT,WCRT,WBRT walkTransitNode\n  class DTT,DLB,DCB,DEB,DLRT,DCRT,DBRT driveTransitNode\n  class LB,CB,EB,LRT,CRT,BRT,WALK,BIKE leafNode\n```\n\n\n# Identify Variable of Interest\n\n## On-Board Survey\n\n### Trip Purposes\n\n::: {#0645b65e .cell execution_count=8}\n``` {.python .cell-code}\ndf_obs_linked[\"Purp5_text\"].value_counts() # Trip Purpose: HBW, HBO, HBC, NHB, HBSch\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nPurp5_text\nHBW      5221\nHBO      4779\nHBC      2358\nNHB      1113\nHBSch     324\nName: count, dtype: int64\n```\n:::\n:::\n\n\n### Peak vs Off-Peak\n\n::: {#db8da5ee .cell execution_count=9}\n``` {.python .cell-code}\ndf_obs_linked[\"PK_OK\"].value_counts() # Peak vs Off-Peak\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nPK_OK\nOK    7656\nPK    6139\nName: count, dtype: int64\n```\n:::\n:::\n\n\n### Motorized vs Non-motorized\n\n::: {#9f2fabc1 .cell execution_count=10}\n``` {.python .cell-code}\ndf_obs_linked[\"Ac_Mode_Model\"].value_counts() # Motorized (Drive) vs Non-motorized (Walk)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\nAc_Mode_Model\nWalk     11016\nDrive     2779\nName: count, dtype: int64\n```\n:::\n:::\n\n\n### Vehicle Ownership\n\n::: {#3272f0eb .cell execution_count=11}\n``` {.python .cell-code}\ndf_obs_linked[\"Veh_Cat3p\"].value_counts() # Vehile Ownership Category: 0, 1, 2, 3+\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nVeh_Cat3p\n0    4251\n1    3877\n2    3358\n3    2309\nName: count, dtype: int64\n```\n:::\n:::\n\n\n# Trips: Motorized vs Non-motorized\n\n\n\n## Non-motorized Trips: Walk vs Bike\n\n\n\n## Motorized Trips: Auto vs Transit\n\n\n\n### Auto Trips: Drive Alone vs Shared Rides\n\n\n\n#### Shared Rides: 2 People vs 3+ People\n\n\n\n### Transit Trips: By Service and By Access Mode\n\n#### By Service Type\n\n::: {#bab382c2 .cell execution_count=12}\n``` {.python .cell-code}\ndf_obs_linked[[\n    \"Linked_Mode_txt\", # Linked Mode: MT = MicroTransit (dont need), LCL = local bus, COR = Core Bus, EXP = Express Bus, LRT = Light Rail Transit (TRAX), CRT = Commuter Rail Transit (FrontRunner), BRT = Bus Rapid Transit (OVX, UVX)\n    \"Purp5_text\", # Trip Purpose: HBW = Home-based Work, HBO = Home-based Other, HBC = Home-based College, NHB = Non-home based, HBSch = Home-based School\n    \"PK_OK\", # Peak vs OffPeak\n    \"Veh_Cat3p\", # Vehicle Ownership: 0 = 0 Vehicle Household, 1 = 1 Vehicle Household, 2 = 2 Vehicle Household, 3 = 3+ Vehicle Household\n    \"Mode_Fin\", # Current Mode: 1 = MT = MicroTransit (Dont need),  4 = LCL = local bus, 5 = COR = Core Bus, 6 = EXP = Express Bus, 7 = LRT = Light Rail Transit (TRAX), 8 = CRT = Commuter Rail Transit, 9 = BRT = Bus Rapid Transit (OVX, UVX)\n    \"Ac_Mode_Model\", # Access Mode to Transit: Walk (Walk to Transit), Drive (Drive to Transit)\n]].describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Veh_Cat3p</th>\n      <th>Mode_Fin</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>13795.000000</td>\n      <td>13795.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>1.270025</td>\n      <td>5.927510</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>1.071571</td>\n      <td>1.875096</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.000000</td>\n      <td>1.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>0.000000</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>1.000000</td>\n      <td>7.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>2.000000</td>\n      <td>7.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>3.000000</td>\n      <td>9.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#f837421b .cell execution_count=13}\n``` {.python .cell-code}\n# Mode mapping for service types\nservice_type_mapping = {\n    'LCL': 'local',\n    'COR': 'core',\n    'EXP': 'express',\n    'LRT': 'lrt',\n    'CRT': 'crt',\n    'BRT': 'brt'\n}\n\ndf_transit_by_service = calculate_mode_shares(\n    df=df_obs_linked,\n    mode_col='Linked_Mode_txt',\n    filter_conditions=None,  # Use all transit trips\n    mode_mapping=service_type_mapping,\n    prefix='calib_share'\n)\n\nprint(\"Transit by Service Type:\")\ndisplay(df_transit_by_service)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTransit by Service Type:\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HBC_Daily</th>\n      <th>HBO_OK</th>\n      <th>HBO_PK</th>\n      <th>HBSch_Daily</th>\n      <th>HBW_OK</th>\n      <th>HBW_PK</th>\n      <th>NHB_OK</th>\n      <th>NHB_PK</th>\n    </tr>\n    <tr>\n      <th>variable</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>calib_share_brt_0veh</th>\n      <td>0.235849</td>\n      <td>0.088020</td>\n      <td>0.097946</td>\n      <td>0.032258</td>\n      <td>0.048316</td>\n      <td>0.055925</td>\n      <td>0.092715</td>\n      <td>0.072289</td>\n    </tr>\n    <tr>\n      <th>calib_share_crt_0veh</th>\n      <td>0.023585</td>\n      <td>0.014670</td>\n      <td>0.020537</td>\n      <td>0.000000</td>\n      <td>0.023426</td>\n      <td>0.015979</td>\n      <td>0.013245</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_express_0veh</th>\n      <td>0.002358</td>\n      <td>0.000000</td>\n      <td>0.001580</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.001332</td>\n      <td>0.000000</td>\n      <td>0.006024</td>\n    </tr>\n    <tr>\n      <th>calib_share_local_0veh</th>\n      <td>0.620283</td>\n      <td>0.600652</td>\n      <td>0.631912</td>\n      <td>0.870968</td>\n      <td>0.672035</td>\n      <td>0.732357</td>\n      <td>0.566225</td>\n      <td>0.608434</td>\n    </tr>\n    <tr>\n      <th>calib_share_lrt_0veh</th>\n      <td>0.117925</td>\n      <td>0.296659</td>\n      <td>0.248025</td>\n      <td>0.096774</td>\n      <td>0.256223</td>\n      <td>0.194407</td>\n      <td>0.327815</td>\n      <td>0.313253</td>\n    </tr>\n    <tr>\n      <th>calib_share_brt_1veh</th>\n      <td>0.241987</td>\n      <td>0.058201</td>\n      <td>0.053398</td>\n      <td>0.032258</td>\n      <td>0.042120</td>\n      <td>0.034335</td>\n      <td>0.107527</td>\n      <td>0.084034</td>\n    </tr>\n    <tr>\n      <th>calib_share_crt_1veh</th>\n      <td>0.057692</td>\n      <td>0.058201</td>\n      <td>0.067961</td>\n      <td>0.021505</td>\n      <td>0.058424</td>\n      <td>0.067597</td>\n      <td>0.032258</td>\n      <td>0.067227</td>\n    </tr>\n    <tr>\n      <th>calib_share_express_1veh</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.005435</td>\n      <td>0.008584</td>\n      <td>0.005376</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_local_1veh</th>\n      <td>0.491987</td>\n      <td>0.509259</td>\n      <td>0.480583</td>\n      <td>0.849462</td>\n      <td>0.576087</td>\n      <td>0.599785</td>\n      <td>0.510753</td>\n      <td>0.495798</td>\n    </tr>\n    <tr>\n      <th>calib_share_lrt_1veh</th>\n      <td>0.208333</td>\n      <td>0.374339</td>\n      <td>0.398058</td>\n      <td>0.096774</td>\n      <td>0.317935</td>\n      <td>0.289700</td>\n      <td>0.344086</td>\n      <td>0.352941</td>\n    </tr>\n    <tr>\n      <th>calib_share_brt_2veh</th>\n      <td>0.194313</td>\n      <td>0.058140</td>\n      <td>0.047244</td>\n      <td>0.032787</td>\n      <td>0.027586</td>\n      <td>0.041835</td>\n      <td>0.153226</td>\n      <td>0.046875</td>\n    </tr>\n    <tr>\n      <th>calib_share_crt_2veh</th>\n      <td>0.072670</td>\n      <td>0.063953</td>\n      <td>0.068241</td>\n      <td>0.016393</td>\n      <td>0.091379</td>\n      <td>0.098516</td>\n      <td>0.040323</td>\n      <td>0.015625</td>\n    </tr>\n    <tr>\n      <th>calib_share_express_2veh</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.002625</td>\n      <td>0.000000</td>\n      <td>0.008621</td>\n      <td>0.016194</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_local_2veh</th>\n      <td>0.500790</td>\n      <td>0.443314</td>\n      <td>0.519685</td>\n      <td>0.844262</td>\n      <td>0.482759</td>\n      <td>0.527665</td>\n      <td>0.451613</td>\n      <td>0.562500</td>\n    </tr>\n    <tr>\n      <th>calib_share_lrt_2veh</th>\n      <td>0.232227</td>\n      <td>0.434593</td>\n      <td>0.362205</td>\n      <td>0.106557</td>\n      <td>0.389655</td>\n      <td>0.315789</td>\n      <td>0.354839</td>\n      <td>0.375000</td>\n    </tr>\n    <tr>\n      <th>calib_share_brt_all</th>\n      <td>0.216929</td>\n      <td>0.069453</td>\n      <td>0.070823</td>\n      <td>0.032362</td>\n      <td>0.040336</td>\n      <td>0.043199</td>\n      <td>0.110000</td>\n      <td>0.086207</td>\n    </tr>\n    <tr>\n      <th>calib_share_crt_all</th>\n      <td>0.060400</td>\n      <td>0.048875</td>\n      <td>0.052663</td>\n      <td>0.029126</td>\n      <td>0.067647</td>\n      <td>0.069975</td>\n      <td>0.025714</td>\n      <td>0.027094</td>\n    </tr>\n    <tr>\n      <th>calib_share_express_all</th>\n      <td>0.000851</td>\n      <td>0.000000</td>\n      <td>0.001211</td>\n      <td>0.000000</td>\n      <td>0.005462</td>\n      <td>0.009996</td>\n      <td>0.001429</td>\n      <td>0.002463</td>\n    </tr>\n    <tr>\n      <th>calib_share_local_all</th>\n      <td>0.515100</td>\n      <td>0.519936</td>\n      <td>0.549031</td>\n      <td>0.847896</td>\n      <td>0.565126</td>\n      <td>0.606569</td>\n      <td>0.518571</td>\n      <td>0.559113</td>\n    </tr>\n    <tr>\n      <th>calib_share_lrt_all</th>\n      <td>0.206721</td>\n      <td>0.361736</td>\n      <td>0.326271</td>\n      <td>0.090615</td>\n      <td>0.321429</td>\n      <td>0.270261</td>\n      <td>0.344286</td>\n      <td>0.325123</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### By Access Mode: Walk vs Drive to Transit\n\n::: {#ae5cce90 .cell execution_count=14}\n``` {.python .cell-code}\naccess_type_mapping = {\n    'Walk': 'walk-to-transit',\n    'Drive': 'drive-to-transit'\n}\n\ndf_transit_by_access = calculate_mode_shares(\n    df=df_obs_linked,\n    mode_col='Ac_Mode_Model',\n    filter_conditions=None,  # Use all transit trips\n    mode_mapping=access_type_mapping,\n    prefix='calib_share'\n)\n\nprint(\"\\nTransit by Access Type:\")\ndisplay(df_transit_by_access)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTransit by Access Type:\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HBC_Daily</th>\n      <th>HBO_OK</th>\n      <th>HBO_PK</th>\n      <th>HBSch_Daily</th>\n      <th>HBW_OK</th>\n      <th>HBW_PK</th>\n      <th>NHB_OK</th>\n      <th>NHB_PK</th>\n    </tr>\n    <tr>\n      <th>variable</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>calib_share_drive-to-transit_0veh</th>\n      <td>0.035294</td>\n      <td>0.045640</td>\n      <td>0.055292</td>\n      <td>0.032258</td>\n      <td>0.037956</td>\n      <td>0.038513</td>\n      <td>0.039604</td>\n      <td>0.018072</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-to-transit_0veh</th>\n      <td>0.964706</td>\n      <td>0.954360</td>\n      <td>0.944708</td>\n      <td>0.967742</td>\n      <td>0.962044</td>\n      <td>0.961487</td>\n      <td>0.960396</td>\n      <td>0.981928</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-to-transit_1veh</th>\n      <td>0.217949</td>\n      <td>0.171958</td>\n      <td>0.179612</td>\n      <td>0.064516</td>\n      <td>0.168022</td>\n      <td>0.194206</td>\n      <td>0.053763</td>\n      <td>0.067227</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-to-transit_1veh</th>\n      <td>0.782051</td>\n      <td>0.828042</td>\n      <td>0.820388</td>\n      <td>0.935484</td>\n      <td>0.831978</td>\n      <td>0.805794</td>\n      <td>0.946237</td>\n      <td>0.932773</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-to-transit_2veh</th>\n      <td>0.380126</td>\n      <td>0.267442</td>\n      <td>0.251969</td>\n      <td>0.172131</td>\n      <td>0.288165</td>\n      <td>0.356275</td>\n      <td>0.048387</td>\n      <td>0.109375</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-to-transit_2veh</th>\n      <td>0.619874</td>\n      <td>0.732558</td>\n      <td>0.748031</td>\n      <td>0.827869</td>\n      <td>0.711835</td>\n      <td>0.643725</td>\n      <td>0.951613</td>\n      <td>0.890625</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-to-transit_all</th>\n      <td>0.324692</td>\n      <td>0.171061</td>\n      <td>0.165860</td>\n      <td>0.116505</td>\n      <td>0.199413</td>\n      <td>0.225829</td>\n      <td>0.048502</td>\n      <td>0.068966</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-to-transit_all</th>\n      <td>0.675308</td>\n      <td>0.828939</td>\n      <td>0.834140</td>\n      <td>0.883495</td>\n      <td>0.800587</td>\n      <td>0.774171</td>\n      <td>0.951498</td>\n      <td>0.931034</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### Walk to Transit\n\n::: {#28e74205 .cell execution_count=15}\n``` {.python .cell-code}\ndf_walk_transit_by_service = calculate_mode_shares(\n    df=df_obs_linked,\n    mode_col='Linked_Mode_txt',\n    filter_conditions={'Ac_Mode_Model': 'Walk'},\n    mode_mapping={\n        'LCL': 'walk-local',\n        'COR': 'walk-core',\n        'EXP': 'walk-express',\n        'LRT': 'walk-lrt',\n        'CRT': 'walk-crt',\n        'BRT': 'walk-brt'\n    },\n    prefix='calib_share'\n)\n\nprint(\"\\nWalk-to-Transit by Service Type:\")\ndisplay(df_walk_transit_by_service)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nWalk-to-Transit by Service Type:\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HBC_Daily</th>\n      <th>HBO_OK</th>\n      <th>HBO_PK</th>\n      <th>HBSch_Daily</th>\n      <th>HBW_OK</th>\n      <th>HBW_PK</th>\n      <th>NHB_OK</th>\n      <th>NHB_PK</th>\n    </tr>\n    <tr>\n      <th>variable</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>calib_share_walk-brt_0veh</th>\n      <td>0.242054</td>\n      <td>0.091375</td>\n      <td>0.102007</td>\n      <td>0.033333</td>\n      <td>0.050228</td>\n      <td>0.058091</td>\n      <td>0.093103</td>\n      <td>0.073620</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-crt_0veh</th>\n      <td>0.007335</td>\n      <td>0.008540</td>\n      <td>0.008361</td>\n      <td>0.000000</td>\n      <td>0.022831</td>\n      <td>0.011065</td>\n      <td>0.003448</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-express_0veh</th>\n      <td>0.002445</td>\n      <td>0.000000</td>\n      <td>0.001672</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.001383</td>\n      <td>0.000000</td>\n      <td>0.006135</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-local_0veh</th>\n      <td>0.633252</td>\n      <td>0.618275</td>\n      <td>0.650502</td>\n      <td>0.900000</td>\n      <td>0.687976</td>\n      <td>0.744122</td>\n      <td>0.582759</td>\n      <td>0.607362</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-lrt_0veh</th>\n      <td>0.114914</td>\n      <td>0.281810</td>\n      <td>0.237458</td>\n      <td>0.066667</td>\n      <td>0.238965</td>\n      <td>0.185339</td>\n      <td>0.320690</td>\n      <td>0.312883</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-brt_1veh</th>\n      <td>0.247951</td>\n      <td>0.067093</td>\n      <td>0.065089</td>\n      <td>0.022989</td>\n      <td>0.044118</td>\n      <td>0.037284</td>\n      <td>0.113636</td>\n      <td>0.090090</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-crt_1veh</th>\n      <td>0.014344</td>\n      <td>0.014377</td>\n      <td>0.014793</td>\n      <td>0.000000</td>\n      <td>0.037582</td>\n      <td>0.027963</td>\n      <td>0.017045</td>\n      <td>0.045045</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-express_1veh</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.003268</td>\n      <td>0.003995</td>\n      <td>0.005682</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-local_1veh</th>\n      <td>0.547131</td>\n      <td>0.570288</td>\n      <td>0.532544</td>\n      <td>0.896552</td>\n      <td>0.650327</td>\n      <td>0.681758</td>\n      <td>0.522727</td>\n      <td>0.522523</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-lrt_1veh</th>\n      <td>0.190574</td>\n      <td>0.348243</td>\n      <td>0.387574</td>\n      <td>0.080460</td>\n      <td>0.264706</td>\n      <td>0.249001</td>\n      <td>0.340909</td>\n      <td>0.342342</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-brt_2veh</th>\n      <td>0.178571</td>\n      <td>0.071429</td>\n      <td>0.052632</td>\n      <td>0.019802</td>\n      <td>0.033981</td>\n      <td>0.041929</td>\n      <td>0.144068</td>\n      <td>0.052632</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-crt_2veh</th>\n      <td>0.010204</td>\n      <td>0.021825</td>\n      <td>0.014035</td>\n      <td>0.000000</td>\n      <td>0.029126</td>\n      <td>0.039832</td>\n      <td>0.025424</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-express_2veh</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.008386</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-local_2veh</th>\n      <td>0.596939</td>\n      <td>0.553571</td>\n      <td>0.631579</td>\n      <td>0.920792</td>\n      <td>0.599515</td>\n      <td>0.666667</td>\n      <td>0.474576</td>\n      <td>0.561404</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-lrt_2veh</th>\n      <td>0.214286</td>\n      <td>0.353175</td>\n      <td>0.301754</td>\n      <td>0.059406</td>\n      <td>0.337379</td>\n      <td>0.243187</td>\n      <td>0.355932</td>\n      <td>0.385965</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-brt_all</th>\n      <td>0.215501</td>\n      <td>0.079907</td>\n      <td>0.082003</td>\n      <td>0.025641</td>\n      <td>0.045168</td>\n      <td>0.047487</td>\n      <td>0.109610</td>\n      <td>0.089947</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-crt_all</th>\n      <td>0.010712</td>\n      <td>0.013964</td>\n      <td>0.010885</td>\n      <td>0.003663</td>\n      <td>0.030987</td>\n      <td>0.029507</td>\n      <td>0.010511</td>\n      <td>0.015873</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-express_all</th>\n      <td>0.000630</td>\n      <td>0.000000</td>\n      <td>0.000726</td>\n      <td>0.000000</td>\n      <td>0.001576</td>\n      <td>0.004149</td>\n      <td>0.001502</td>\n      <td>0.002646</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-local_all</th>\n      <td>0.599874</td>\n      <td>0.589604</td>\n      <td>0.613933</td>\n      <td>0.904762</td>\n      <td>0.650735</td>\n      <td>0.701245</td>\n      <td>0.536036</td>\n      <td>0.576720</td>\n    </tr>\n    <tr>\n      <th>calib_share_walk-lrt_all</th>\n      <td>0.173283</td>\n      <td>0.316524</td>\n      <td>0.292453</td>\n      <td>0.065934</td>\n      <td>0.271534</td>\n      <td>0.217612</td>\n      <td>0.342342</td>\n      <td>0.314815</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##### Drive to Transit\n\n::: {#c8765633 .cell execution_count=16}\n``` {.python .cell-code}\ndf_drive_transit_by_service = calculate_mode_shares(\n    df=df_obs_linked,\n    mode_col='Linked_Mode_txt',\n    filter_conditions={'Ac_Mode_Model': 'Drive'},\n    mode_mapping={\n        'LCL': 'drive-local',\n        'COR': 'drive-core',\n        'EXP': 'drive-express',\n        'LRT': 'drive-lrt',\n        'CRT': 'drive-crt',\n        'BRT': 'drive-brt'\n    },\n    prefix='calib_share'\n)\n\nprint(\"\\nDrive-to-Transit by Service Type:\")\ndisplay(df_drive_transit_by_service)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDrive-to-Transit by Service Type:\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HBC_Daily</th>\n      <th>HBO_OK</th>\n      <th>HBO_PK</th>\n      <th>HBSch_Daily</th>\n      <th>HBW_OK</th>\n      <th>HBW_PK</th>\n      <th>NHB_OK</th>\n      <th>NHB_PK</th>\n    </tr>\n    <tr>\n      <th>variable</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>calib_share_drive-brt_0veh</th>\n      <td>0.066667</td>\n      <td>0.017857</td>\n      <td>0.028571</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.083333</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-crt_0veh</th>\n      <td>0.466667</td>\n      <td>0.142857</td>\n      <td>0.228571</td>\n      <td>0.000000</td>\n      <td>0.038462</td>\n      <td>0.142857</td>\n      <td>0.250000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-local_0veh</th>\n      <td>0.266667</td>\n      <td>0.232143</td>\n      <td>0.314286</td>\n      <td>0.000000</td>\n      <td>0.269231</td>\n      <td>0.428571</td>\n      <td>0.166667</td>\n      <td>0.666667</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-lrt_0veh</th>\n      <td>0.200000</td>\n      <td>0.607143</td>\n      <td>0.428571</td>\n      <td>1.000000</td>\n      <td>0.692308</td>\n      <td>0.428571</td>\n      <td>0.500000</td>\n      <td>0.333333</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-brt_1veh</th>\n      <td>0.220588</td>\n      <td>0.015385</td>\n      <td>0.000000</td>\n      <td>0.166667</td>\n      <td>0.032258</td>\n      <td>0.022099</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-crt_1veh</th>\n      <td>0.213235</td>\n      <td>0.269231</td>\n      <td>0.310811</td>\n      <td>0.333333</td>\n      <td>0.161290</td>\n      <td>0.232044</td>\n      <td>0.300000</td>\n      <td>0.375000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-express_1veh</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.016129</td>\n      <td>0.027624</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-local_1veh</th>\n      <td>0.294118</td>\n      <td>0.215385</td>\n      <td>0.243243</td>\n      <td>0.166667</td>\n      <td>0.209677</td>\n      <td>0.259669</td>\n      <td>0.300000</td>\n      <td>0.125000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-lrt_1veh</th>\n      <td>0.272059</td>\n      <td>0.500000</td>\n      <td>0.445946</td>\n      <td>0.333333</td>\n      <td>0.580645</td>\n      <td>0.458564</td>\n      <td>0.400000</td>\n      <td>0.500000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-brt_2veh</th>\n      <td>0.219917</td>\n      <td>0.021739</td>\n      <td>0.031250</td>\n      <td>0.095238</td>\n      <td>0.011905</td>\n      <td>0.041667</td>\n      <td>0.333333</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-crt_2veh</th>\n      <td>0.174274</td>\n      <td>0.179348</td>\n      <td>0.229167</td>\n      <td>0.095238</td>\n      <td>0.244048</td>\n      <td>0.204545</td>\n      <td>0.333333</td>\n      <td>0.142857</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-express_2veh</th>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.010417</td>\n      <td>0.000000</td>\n      <td>0.029762</td>\n      <td>0.030303</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-local_2veh</th>\n      <td>0.344398</td>\n      <td>0.141304</td>\n      <td>0.187500</td>\n      <td>0.476190</td>\n      <td>0.196429</td>\n      <td>0.276515</td>\n      <td>0.000000</td>\n      <td>0.571429</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-lrt_2veh</th>\n      <td>0.261411</td>\n      <td>0.657609</td>\n      <td>0.541667</td>\n      <td>0.333333</td>\n      <td>0.517857</td>\n      <td>0.446970</td>\n      <td>0.333333</td>\n      <td>0.285714</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-brt_all</th>\n      <td>0.219895</td>\n      <td>0.018797</td>\n      <td>0.014599</td>\n      <td>0.083333</td>\n      <td>0.021008</td>\n      <td>0.028481</td>\n      <td>0.117647</td>\n      <td>0.035714</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-crt_all</th>\n      <td>0.163613</td>\n      <td>0.218045</td>\n      <td>0.262774</td>\n      <td>0.222222</td>\n      <td>0.214286</td>\n      <td>0.208861</td>\n      <td>0.323529</td>\n      <td>0.178571</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-express_all</th>\n      <td>0.001309</td>\n      <td>0.000000</td>\n      <td>0.003650</td>\n      <td>0.000000</td>\n      <td>0.021008</td>\n      <td>0.030063</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-local_all</th>\n      <td>0.339005</td>\n      <td>0.182331</td>\n      <td>0.222628</td>\n      <td>0.416667</td>\n      <td>0.222689</td>\n      <td>0.281646</td>\n      <td>0.176471</td>\n      <td>0.321429</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-lrt_all</th>\n      <td>0.276178</td>\n      <td>0.580827</td>\n      <td>0.496350</td>\n      <td>0.277778</td>\n      <td>0.521008</td>\n      <td>0.450949</td>\n      <td>0.382353</td>\n      <td>0.464286</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#bd8a0d39 .cell execution_count=17}\n``` {.python .cell-code}\n# Concatenate all results\ndf_all_transit_shares = pd.concat([\n    df_transit_by_service,\n    df_transit_by_access,\n    df_walk_transit_by_service,\n    df_drive_transit_by_service\n], axis=0)\n\nprint(\"\\nAll Transit Shares Combined:\")\ndisplay(df_all_transit_shares)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAll Transit Shares Combined:\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>HBC_Daily</th>\n      <th>HBO_OK</th>\n      <th>HBO_PK</th>\n      <th>HBSch_Daily</th>\n      <th>HBW_OK</th>\n      <th>HBW_PK</th>\n      <th>NHB_OK</th>\n      <th>NHB_PK</th>\n    </tr>\n    <tr>\n      <th>variable</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>calib_share_brt_0veh</th>\n      <td>0.235849</td>\n      <td>0.088020</td>\n      <td>0.097946</td>\n      <td>0.032258</td>\n      <td>0.048316</td>\n      <td>0.055925</td>\n      <td>0.092715</td>\n      <td>0.072289</td>\n    </tr>\n    <tr>\n      <th>calib_share_crt_0veh</th>\n      <td>0.023585</td>\n      <td>0.014670</td>\n      <td>0.020537</td>\n      <td>0.000000</td>\n      <td>0.023426</td>\n      <td>0.015979</td>\n      <td>0.013245</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_express_0veh</th>\n      <td>0.002358</td>\n      <td>0.000000</td>\n      <td>0.001580</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.001332</td>\n      <td>0.000000</td>\n      <td>0.006024</td>\n    </tr>\n    <tr>\n      <th>calib_share_local_0veh</th>\n      <td>0.620283</td>\n      <td>0.600652</td>\n      <td>0.631912</td>\n      <td>0.870968</td>\n      <td>0.672035</td>\n      <td>0.732357</td>\n      <td>0.566225</td>\n      <td>0.608434</td>\n    </tr>\n    <tr>\n      <th>calib_share_lrt_0veh</th>\n      <td>0.117925</td>\n      <td>0.296659</td>\n      <td>0.248025</td>\n      <td>0.096774</td>\n      <td>0.256223</td>\n      <td>0.194407</td>\n      <td>0.327815</td>\n      <td>0.313253</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-brt_all</th>\n      <td>0.219895</td>\n      <td>0.018797</td>\n      <td>0.014599</td>\n      <td>0.083333</td>\n      <td>0.021008</td>\n      <td>0.028481</td>\n      <td>0.117647</td>\n      <td>0.035714</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-crt_all</th>\n      <td>0.163613</td>\n      <td>0.218045</td>\n      <td>0.262774</td>\n      <td>0.222222</td>\n      <td>0.214286</td>\n      <td>0.208861</td>\n      <td>0.323529</td>\n      <td>0.178571</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-express_all</th>\n      <td>0.001309</td>\n      <td>0.000000</td>\n      <td>0.003650</td>\n      <td>0.000000</td>\n      <td>0.021008</td>\n      <td>0.030063</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-local_all</th>\n      <td>0.339005</td>\n      <td>0.182331</td>\n      <td>0.222628</td>\n      <td>0.416667</td>\n      <td>0.222689</td>\n      <td>0.281646</td>\n      <td>0.176471</td>\n      <td>0.321429</td>\n    </tr>\n    <tr>\n      <th>calib_share_drive-lrt_all</th>\n      <td>0.276178</td>\n      <td>0.580827</td>\n      <td>0.496350</td>\n      <td>0.277778</td>\n      <td>0.521008</td>\n      <td>0.450949</td>\n      <td>0.382353</td>\n      <td>0.464286</td>\n    </tr>\n  </tbody>\n</table>\n<p>67 rows Ã— 8 columns</p>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}